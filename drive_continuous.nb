(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    219622,       5913]
NotebookOptionsPosition[    212759,       5698]
NotebookOutlinePosition[    213115,       5714]
CellTagsIndexPosition[    213072,       5711]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Drive model - continuous evolution", "Section",
 CellChangeTimes->{{3.672823773140544*^9, 3.672823774861123*^9}, {
  3.6728238536380167`*^9, 3.672823874083127*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.67282387608633*^9, 3.672823891420663*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model Setup", "Section",
 CellChangeTimes->{{3.672824021459476*^9, 3.672824027330594*^9}, {
  3.6728247326750298`*^9, 3.672824734241405*^9}}],

Cell["Setup haplotypes and essential functions", "Text",
 CellChangeTimes->{{3.6728243871626863`*^9, 3.6728243938718777`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"haplos", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
    RowBox[{"{", "Y", "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.67282403676058*^9, 3.6728241935434504`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
   RowBox[{"{", "Y", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.672824159234543*^9, 3.6728242344383802`*^9, 
  3.672828265075212*^9, 3.672829960170866*^9, 3.672832761342641*^9, 
  3.672934994718956*^9, 3.672977137273571*^9, 3.6729783045496883`*^9, 
  3.672981929286232*^9, 3.6729819657746363`*^9, 3.672982069303585*^9, 
  3.67298510478402*^9, 3.672993457681273*^9, 3.672998589479887*^9, 
  3.6730040036914663`*^9, 3.673007573181478*^9, 3.6730747454758587`*^9, 
  3.673074909164501*^9, 3.673114435304632*^9, 3.673183040491746*^9, 
  3.6731846401151123`*^9, 3.673184897383108*^9, 3.673245569905411*^9, 
  3.673247128268545*^9, 3.673247409163138*^9, 3.673255112215928*^9, 
  3.673255778049334*^9}]
}, Open  ]],

Cell["\<\
Viability selection based on the SA locus, making use of the global variables \
that specify the allelic \[OpenCurlyQuote]phenotypes\[CloseCurlyQuote] x1 and \
x2.\
\>", "Text",
 CellChangeTimes->{{3.672824433743085*^9, 3.672824441299214*^9}, {
  3.672825032444066*^9, 3.67282504969109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"geno", ",", "z", ",", "val", ",", "sex"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"geno", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sex", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "0"}], ",", "f", 
        ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "determine", " ", "phenotype", " ", "based", " ", "on", " ", "the", 
        " ", "global", " ", "allelic", " ", "phenotypes", " ", "for", " ", 
        "the", " ", "SA", " ", "locus"}], ",", " ", 
       RowBox[{
        RowBox[{"x1", " ", "&"}], " ", "x2"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]1"}], "]"}], "x1"}], "+", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]2"}], "]"}], "x2"}], "+", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]1m"}], "]"}], "x1m"}], "+", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]2m"}], "]"}], "x2m"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"val", "=", 
      RowBox[{
       RowBox[{"\[Kappa]", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z", "-", 
              RowBox[{"th", "[", "sex", "]"}]}], ")"}], "2"]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            SuperscriptBox["sv", "2"]}], ")"}]}], "]"}]}], "+", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Kappa]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "val", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672824283809176*^9, 3.672824332894318*^9}, {
  3.672824369325102*^9, 3.6728243711429977`*^9}, {3.672824820386063*^9, 
  3.672824847474188*^9}, {3.672824917902295*^9, 3.672824929994944*^9}, {
  3.6728249692368383`*^9, 3.6728250619381742`*^9}, {3.672825521644678*^9, 
  3.672825541725829*^9}, {3.672827428154134*^9, 3.672827450873543*^9}, {
  3.672831717782721*^9, 3.67283173815593*^9}, {3.6728327554735622`*^9, 
  3.672832757439049*^9}, {3.672982021563662*^9, 3.672982034523773*^9}}],

Cell["Viability selection based on the drive locus", "Text",
 CellChangeTimes->{{3.6728244438474607`*^9, 3.672824451206585*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"geno", ",", "z", ",", "val", ",", "sex"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"geno", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sex", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "0"}], ",", "f", 
        ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"geno", ",", "Xd"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "sex", "}"}], ",", "f"}], "]"}], "\[Equal]", "0"}], 
       ",", 
       RowBox[{"Return", "[", 
        RowBox[{"1", "-", 
         RowBox[{"z", "*", "cmd"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"h", " ", "cfd"}]}], ",", 
        RowBox[{"z", "\[Equal]", "2"}], ",", 
        RowBox[{"1", "-", "cfd"}], ",", 
        RowBox[{"z", "\[Equal]", "0"}], ",", "1"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6728246765310383`*^9, 3.672824728348208*^9}, {
  3.672825069807102*^9, 3.672825227216508*^9}, {3.672825260031679*^9, 
  3.6728253417973967`*^9}, {3.672825434680388*^9, 3.67282543482504*^9}, {
  3.672827458687368*^9, 3.672827467816565*^9}}],

Cell["Check with a table of values:", "Text",
 CellChangeTimes->{{3.6728263716180267`*^9, 3.672826379937607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hapi", ",", "hapj", ",", "sex", ",", 
        RowBox[{"y", "[", 
         RowBox[{"hapi", ",", "hapj", ",", "sex"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"hapi", ",", "haplos"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"hapj", ",", "haplos"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"sex", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "m"}], "}"}]}], "}"}]}], "]"}], ",", "2"}], "]"}], 
  "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672825366979681*^9, 3.6728254854754667`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.672825420873879*^9, 3.672825485882141*^9}, 
   3.672828265135356*^9, 3.672829960238817*^9, 3.6728327614269943`*^9, 
   3.672934994894232*^9, 3.672977137331873*^9, 3.672978304612455*^9, 
   3.672981929370967*^9, 3.6729819658473597`*^9, 3.672982069387019*^9, 
   3.672985104846345*^9, 3.672993457725398*^9, 3.672998589530889*^9, 
   3.673004003822454*^9, 3.673007573235676*^9, 3.6730747455353622`*^9, 
   3.673074909223282*^9, 3.673114435397839*^9, 3.67318304053111*^9, 
   3.6731846402283287`*^9, 3.673184897482356*^9, 3.673245569967082*^9, 
   3.673247128360195*^9, 3.673247409337435*^9, 3.6732551122871437`*^9, 
   3.673255778130067*^9}]
}, Open  ]],

Cell["Gamete production function", "Text",
 CellChangeTimes->{{3.672826463744356*^9, 3.672826464542344*^9}, {
  3.67282654546624*^9, 3.672826547121277*^9}, {3.6728267548620462`*^9, 
  3.672826760951519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gam", "[", 
    RowBox[{"hapMom_", ",", "hapDad_", ",", "hapGoal_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "geno", ",", "sex", ",", "hapNoRec", ",", "hapRec", ",", "drive"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"geno", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sex", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "0"}], ",", "f", 
         ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drive", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"hapMom", ",", "Xd"}], "]"}], ">", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"hapGoal", ",", "Xd"}], "]"}], ">", "0"}], ",", "k", ",", 
           RowBox[{"1", "-", "k"}]}], "]"}], ",", 
         FractionBox["1", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hapNoRec", "=", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", "hapDad"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"drive", " ", 
          RowBox[{"Count", "[", 
           RowBox[{"hapNoRec", ",", "hapGoal"}], "]"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "only", " ", "deal", " ", "with", " ", "females", " ", "from", " ", 
        "now", " ", "on"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hapRec", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"hapMom", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"hapDad", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"hapDad", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"hapMom", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"Count", "[", 
           RowBox[{"hapNoRec", ",", "hapGoal"}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], "r", "  ", 
          RowBox[{"Count", "[", 
           RowBox[{"hapRec", ",", "hapGoal"}], "]"}]}]}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6728267883949203`*^9, 3.672826812913519*^9}, {
  3.672827277515675*^9, 3.6728272913965282`*^9}, {3.672827324617877*^9, 
  3.672827403966061*^9}, {3.672827488291081*^9, 3.672827651553219*^9}, {
  3.672827706589932*^9, 3.6728278163652477`*^9}, {3.672828008827561*^9, 
  3.6728280917498817`*^9}, {3.672828131863368*^9, 3.672828134416112*^9}, {
  3.6728281897880287`*^9, 3.67282820716295*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mom", ",", "dad", ",", "goal", ",", 
      RowBox[{"gam", "[", 
       RowBox[{"mom", ",", "dad", ",", "goal"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mom", ",", 
      RowBox[{"haplos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dad", ",", 
      RowBox[{"haplos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"goal", ",", 
      RowBox[{"haplos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672978971550404*^9, 3.672979056788786*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          FractionBox["1", "2"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          FractionBox["1", "2"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "k"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"1", "-", "k"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "k"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"1", "-", "k"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6729789957566967`*^9, 3.672979016925849*^9}, {
   3.672979051761594*^9, 3.672979057208139*^9}, 3.672981929455317*^9, 
   3.672981965910225*^9, 3.672982069437611*^9, 3.672985104903257*^9, 
   3.672993457772422*^9, 3.672998589586214*^9, 3.673004003920895*^9, 
   3.673007573289315*^9, 3.673074745605866*^9, 3.6730749092970257`*^9, 
   3.673114435475314*^9, 3.673183040629228*^9, 3.673184640297799*^9, 
   3.673184897532269*^9, 3.673245570076274*^9, 3.673247128407569*^9, 
   3.6732474094487543`*^9, 3.673255112336816*^9, 3.6732557782050047`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gam", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"haplos", "[", 
    RowBox[{"[", "5", "]"}], "]"}], ",", 
   RowBox[{"{", "Y", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67282806603025*^9, 3.6728281087721233`*^9}, {
  3.672828142484242*^9, 3.6728282120724573`*^9}, {3.672831175172221*^9, 
  3.672831216289475*^9}, {3.672831362690749*^9, 3.672831368233857*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", "k"}]], "Output",
 CellChangeTimes->{{3.6728281020941887`*^9, 3.6728282127444773`*^9}, 
   3.672828265219673*^9, 3.6728299602968903`*^9, {3.672831175579035*^9, 
   3.672831216673134*^9}, 3.672831368571439*^9, 3.672832761483467*^9, 
   3.672934994970273*^9, 3.67297714537659*^9, 3.6729783046307163`*^9, 
   3.672981929495921*^9, 3.67298196594368*^9, 3.672982069457142*^9, 
   3.672985104932824*^9, 3.67299345779801*^9, 3.672998589614559*^9, 
   3.6730040039766083`*^9, 3.6730075733149233`*^9, 3.6730747456323233`*^9, 
   3.673074909324101*^9, 3.673114435548074*^9, 3.673183040649995*^9, 
   3.673184640337019*^9, 3.673184897552994*^9, 3.67324557008354*^9, 
   3.6732471284325247`*^9, 3.673247409496852*^9, 3.673255112356007*^9, 
   3.673255778239212*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident allele frequency recursions", "Section",
 CellChangeTimes->{{3.672824742199346*^9, 3.672824746350585*^9}, {
  3.672833348135971*^9, 3.672833351895883*^9}}],

Cell["Recursion of F:", "Text",
 CellChangeTimes->{{3.6728333888061047`*^9, 3.672833391885646*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wbar", "[", "hapdad_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "hapMom", "]"}], 
      RowBox[{"\[ScriptF]", "[", "hapDad", "]"}], 
      RowBox[{"v", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}], 
      RowBox[{"y", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"hapMom", ",", 
       RowBox[{"haplos", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapDad", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"hapdad", ",", "Y"}], "]"}], ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}], ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "[", "hapMom", "]"}], 
    RowBox[{"\[ScriptF]", "[", "hapDad", "]"}], 
    RowBox[{"v", "[", 
     RowBox[{"hapMom", ",", "hapDad"}], "]"}], 
    RowBox[{
     RowBox[{"y", "[", 
      RowBox[{"hapMom", ",", "hapDad"}], "]"}], "/", 
     RowBox[{"wbar", "[", "hapDad", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672824750271644*^9, 3.672824811826009*^9}, {
  3.672825548342643*^9, 3.672825758079356*^9}, {3.672828240881497*^9, 
  3.672828247342502*^9}, {3.672833356229332*^9, 3.672833375874881*^9}, {
  3.67297860961763*^9, 3.6729786607117434`*^9}, {3.672979218479046*^9, 
  3.672979307354424*^9}, {3.67297936386596*^9, 3.672979366457499*^9}}],

Cell["Ova next generation:", "Text",
 CellChangeTimes->{{3.672830282689686*^9, 3.672830284760461*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fova", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"hapDad", ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", 
       RowBox[{"haplos", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6728298328340197`*^9, 3.672829965342061*^9}, {
  3.672829997287568*^9, 3.672829998357175*^9}, {3.672830108094942*^9, 
  3.672830108399049*^9}, {3.672830139087572*^9, 3.672830140611923*^9}, {
  3.672830302920137*^9, 3.6728303031501637`*^9}, {3.672978037299354*^9, 
  3.672978039164178*^9}}],

Cell["Sperm next generation", "Text",
 CellChangeTimes->{{3.672830287094174*^9, 3.6728302891101093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsperm", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplos"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672830296943138*^9, 3.672830313774301*^9}, {
  3.672831245482638*^9, 3.6728312467555027`*^9}, {3.672831405745208*^9, 
  3.6728314260021152`*^9}}],

Cell["\<\
Substitute for the explicit recursion from parental gametes using the \
function \[ScriptCapitalF]:\
\>", "Text",
 CellChangeTimes->{{3.6728335298314533`*^9, 3.672833547862813*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fovaExpl", "=", 
   RowBox[{"fova", "/.", 
    RowBox[{"{", 
     RowBox[{"F", "->", "\[ScriptCapitalF]"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fspermExpl", "=", 
   RowBox[{"fsperm", "/.", 
    RowBox[{"{", 
     RowBox[{"F", "->", "\[ScriptCapitalF]"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672833507569139*^9, 3.6728335249861593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "fsperm", "]"}]], "Input",
 CellChangeTimes->{{3.672978007104497*^9, 3.6729780516720457`*^9}}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.672978010583929*^9, 3.672978051985186*^9}, 
   3.672978304764537*^9, 3.672978702794471*^9, 3.672979317409212*^9, 
   3.672979370780582*^9, 3.6729819296624413`*^9, 3.6729819660349407`*^9, 
   3.67298206954778*^9, 3.672985105016801*^9, 3.672993457882207*^9, 
   3.672998589703004*^9, 3.6730040041127663`*^9, 3.673007573406199*^9, 
   3.673074745722919*^9, 3.673074909415024*^9, 3.673114435701704*^9, 
   3.6731830407267017`*^9, 3.673184640425798*^9, 3.673184897669046*^9, 
   3.673245570188839*^9, 3.673247128514214*^9, 3.673247409629128*^9, 
   3.673255112540915*^9, 3.673255778439333*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673000037093449*^9, 3.673000038649267*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Mutant allele frequencies X1m", "Section",
 CellChangeTimes->{{3.6728319528344173`*^9, 3.6728319555860863`*^9}, 
   3.672837429855502*^9, {3.6731820128378468`*^9, 3.673182017811647*^9}}],

Cell["We now consider the mutant SA allele \[ScriptCapitalX]1m next to \
\[ScriptCapitalX]1 and \[ScriptCapitalX]2:", "Text",
 CellChangeTimes->{{3.67283198959264*^9, 3.672831992487815*^9}, {
   3.672832102234517*^9, 3.672832125833947*^9}, 3.672837429855732*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"haplosx1m", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6728320359137793`*^9, 3.672832077698114*^9}, {
   3.67283216143755*^9, 3.672832164075441*^9}, {3.672832322605207*^9, 
   3.672832325643944*^9}, 3.672835141503418*^9, 3.6728374298561983`*^9, {
   3.673183160117548*^9, 3.673183160360836*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fovax1m", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gam", "[", 
          RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
         RowBox[{"F", "[", 
          RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hapDad", ",", "haplosx1m"}], "}"}]}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gam", "[", 
          RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
         RowBox[{"F", "[", 
          RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"hapMom", ",", "haplosx1m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hapDad", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplosx1m"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.672832145873275*^9, 3.672832171741993*^9}, {
   3.672832224204438*^9, 3.672832263888403*^9}, {3.672832355602874*^9, 
   3.672832385031159*^9}, {3.672832572309833*^9, 3.6728325740210752`*^9}, 
   3.6728374298578176`*^9, {3.67318316390143*^9, 3.673183171153944*^9}, {
   3.6731832167953787`*^9, 3.673183219362564*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fspermx1m", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", "haplosx1m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"hapDad", ",", 
         RowBox[{"{", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplosx1m"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.672832145873275*^9, 3.672832171741993*^9}, {
   3.672832224204438*^9, 3.672832263888403*^9}, {3.672832355602874*^9, 
   3.672832385031159*^9}, {3.67283244022805*^9, 3.672832475663526*^9}, {
   3.672832577043407*^9, 3.672832578107572*^9}, 3.6728374298590317`*^9, {
   3.6731832762895727`*^9, 3.6731832783293343`*^9}, {3.6731842730911007`*^9, 
   3.6731842734954576`*^9}}],

Cell["\<\
Try to approximate things as in Eq. A7 in Van Doorn & Dieckmann 2006. This is \
not mega-easy\
\>", "Text",
 CellChangeTimes->{{3.6728346973290577`*^9, 3.672834711405835*^9}, {
   3.672835903398366*^9, 3.672835906070771*^9}, 3.6728374298597383`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalF]approx", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"hapMom", ",", "hapDad"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1m", "\[Rule]", "x1"}], ",", 
         RowBox[{"x2m", "\[Rule]", "x2"}]}], "}"}]}], ")"}], 
     RowBox[{"\[ScriptCapitalF]", "[", 
      RowBox[{
       RowBox[{"hapMom", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}], ",", 
          RowBox[{"\[ScriptCapitalX]2m", "->", "\[ScriptCapitalX]2"}]}], 
         "}"}]}], ",", 
       RowBox[{"hapDad", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}], ",", 
          RowBox[{"\[ScriptCapitalX]2m", "->", "\[ScriptCapitalX]2"}]}], 
         "}"}]}]}], "]"}]], ")"}], 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"hapMom", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}], ",", 
        RowBox[{"\[ScriptCapitalX]2m", "->", "\[ScriptCapitalX]2"}]}], 
       "}"}]}], ",", 
     RowBox[{"hapDad", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}], ",", 
        RowBox[{"\[ScriptCapitalX]2m", "->", "\[ScriptCapitalX]2"}]}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.672834828971525*^9, 3.6728349598282557`*^9}, {
   3.672835000598819*^9, 3.672835000976489*^9}, {3.672835053048051*^9, 
   3.672835096381859*^9}, 3.672835172112982*^9, 3.67283742986301*^9, {
   3.673183291457533*^9, 3.673183320719002*^9}, {3.673184685668624*^9, 
   3.673184685790092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalF]approx2", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"hapMom", ",", "hapDad"}], "]"}], ",", "x1m"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"x1m", "\[Rule]", "x1"}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"hapMom", ",", "hapDad"}], "]"}], ",", "x2m"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"x2m", "\[Rule]", "x2"}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.672834828971525*^9, 3.6728349598282557`*^9}, {
   3.672835000598819*^9, 3.672835000976489*^9}, {3.672835053048051*^9, 
   3.672835096381859*^9}, 3.672835172112982*^9, 3.67283742986301*^9, {
   3.672837882113562*^9, 3.672837917923603*^9}, 3.673007560748815*^9, {
   3.673183352157256*^9, 3.6731833576544237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffx", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cl", ",", "len"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cl", "=", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "cl", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cl", "]"}], ">", "1"}], ",", 
        RowBox[{"cl", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672837462350689*^9, 3.672837514239416*^9}, {
  3.672837661203617*^9, 3.672837668845683*^9}, {3.67283773153292*^9, 
  3.672837784075696*^9}, {3.672999901180318*^9, 3.672999904205718*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FFx1m", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx1m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6728360928824453`*^9, 3.672836165366435*^9}, {
   3.672837187926056*^9, 3.672837279427154*^9}, 3.672837429870335*^9, {
   3.672837542951679*^9, 3.6728375990198603`*^9}, {3.672837638313529*^9, 
   3.6728376461492577`*^9}, {3.6728378030499077`*^9, 3.6728378400055313`*^9}, 
   3.672940253614581*^9, {3.672999909185938*^9, 3.672999909344338*^9}, {
   3.6730032569327374`*^9, 3.673003305047267*^9}, {3.673183369100361*^9, 
   3.673183369727971*^9}, {3.673184238004147*^9, 3.67318429456883*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FF2x1m", "=", "FFx1m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x1m", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx1m", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x1m", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx1m", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x1m", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx1m", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x1m", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx1m", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672940461883422*^9, 3.6729405464832067`*^9}, {
  3.6731834655297747`*^9, 3.673183496860594*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FF2x1m", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672996557318204*^9, 3.672996560312999*^9}, {
  3.6731835034737883`*^9, 3.6731835038912287`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"f", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptF]", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"f", "[", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptF]", "[", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}]},
     {
      FractionBox[
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", "Y", "}"}]}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "0", "0",
       "0"},
     {"0", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
          RowBox[{"{", "Y", "}"}]}], "]"}]}], 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.672996560721681*^9, 3.672998590011815*^9, 3.672999913475684*^9, 
   3.6730026190457077`*^9, 3.673002660737653*^9, 3.673003277306041*^9, 
   3.6730040047976923`*^9, 3.6730075737408047`*^9, 3.673074746146531*^9, 
   3.673074909814513*^9, 3.6731144361486607`*^9, 3.673183041051594*^9, {
   3.673183509387006*^9, 3.6731835179246387`*^9}, 3.673184319955613*^9, 
   3.673184640725461*^9, 3.6731846915020733`*^9, 3.67318489800762*^9, 
   3.673245570505389*^9, {3.673247128803164*^9, 3.6732471399778214`*^9}, 
   3.673247409968484*^9, 3.6732551128435173`*^9, 3.673255778817527*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix F eigenvectors", "Subsection",
 CellChangeTimes->{{3.672992907996264*^9, 3.672992914172285*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vvalsx1m", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"vf0x1m", ",", "vf1x1m", ",", "vm0x1m", ",", "vm1x1m"}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvalsx1m", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "uf0x1m", "}"}], ",", 
     RowBox[{"{", "uf1x1m", "}"}], ",", 
     RowBox[{"{", "um0x1m", "}"}], ",", 
     RowBox[{"{", "um1x1m", "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6729924768251743`*^9, 3.67299248634032*^9}, {
  3.6729932209798737`*^9, 3.6729932374200153`*^9}, {3.673246871022183*^9, 
  3.673246886999236*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uveqsx1m", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2x1m", ".", "uvalsx1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "uf1x1m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2x1m", ".", "uvalsx1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "um0x1m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2x1m", ".", "uvalsx1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "um1x1m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx1m", ".", "FF2x1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "vf0x1m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx1m", ".", "FF2x1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "vf1x1m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx1m", ".", "FF2x1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "vm0x1m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx1m", ".", "FF2x1m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x1m", " ", "vm1x1m"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672997265098961*^9, 3.672997400035041*^9}, {
  3.672997460865128*^9, 3.672997461744545*^9}, {3.673001065167368*^9, 
  3.673001080867169*^9}, {3.673001947158779*^9, 3.673001947261565*^9}, {
  3.6730023657303762`*^9, 3.6730023741751127`*^9}, {3.673002428000701*^9, 
  3.673002441356019*^9}, {3.6730024792464314`*^9, 3.673002499233531*^9}, {
  3.6730026525936623`*^9, 3.673002652922413*^9}, {3.6731835574862623`*^9, 
  3.673183559987419*^9}, {3.6731840025108843`*^9, 3.673184016797031*^9}, {
  3.673246848733645*^9, 3.6732468586365013`*^9}, {3.6732469017432957`*^9, 
  3.673246912360654*^9}, {3.6732471069580593`*^9, 3.67324711817142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uveqs2x1m", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"uveqsx1m", ",", 
      RowBox[{"4", "\[Rule]", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"uvalsx1m", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"vvalsx1m", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "\[Equal]", 
        "1"}]}]}], "]"}], "/.", 
    RowBox[{"uf0x1m", "\[Rule]", 
     RowBox[{"1", "-", "uf1x1m", "-", "um0x1m", "-", "um1x1m"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67300251737919*^9, 3.67300255984381*^9}, 
   3.67300265643176*^9, {3.673184027570773*^9, 3.673184028524667*^9}, 
   3.673246561640403*^9, {3.673246914687707*^9, 3.673246920927496*^9}, {
   3.673247133958301*^9, 3.6732471363816233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsolsx1m", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"uveqs2x1m", ",", 
       RowBox[{"{", 
        RowBox[{
        "uf1x1m", ",", "um0x1m", ",", "um1x1m", ",", "vf0x1m", ",", "vf1x1m", 
         ",", "vm0x1m", ",", "vm1x1m"}], "}"}]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672997413146058*^9, 3.6729974771776323`*^9}, 
   3.673002562059359*^9, {3.6731840342216997`*^9, 3.673184036773985*^9}, {
   3.673246925838215*^9, 3.673246938829039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsolsExplx1m", "=", 
   RowBox[{"uvsolsx1m", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673000901373358*^9, 3.673000932022674*^9}, {
  3.673184046883863*^9, 3.673184049378336*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charPolx1m", "=", 
   RowBox[{
    RowBox[{"CharacteristicPolynomial", "[", 
     RowBox[{"FF2x1m", ",", "\[Lambda]x1m"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"charPolExplx1m", "=", 
   RowBox[{"charPolx1m", "/.", 
    RowBox[{"F", "->", "\[ScriptCapitalF]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673002764942953*^9, 3.673002786526408*^9}, {
  3.6730028869619637`*^9, 3.673002914408588*^9}, {3.6730034167768917`*^9, 
  3.673003423524884*^9}, {3.673184053316313*^9, 3.67318406189779*^9}, {
  3.6732470954457493`*^9, 3.673247096757744*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix W", "Subsection",
 CellChangeTimes->{{3.672992925371107*^9, 3.6729929265803347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wx1m", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx1m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}]}], "}"}], "/.", 
    RowBox[{"Null", "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6728360928824453`*^9, 3.672836165366435*^9}, {
   3.672837187926056*^9, 3.672837279427154*^9}, 3.672837429870335*^9, {
   3.672837542951679*^9, 3.6728375990198603`*^9}, {3.672837638313529*^9, 
   3.6728376461492577`*^9}, {3.6728378030499077`*^9, 
   3.6728378400055313`*^9}, {3.672837962210178*^9, 3.672837981624482*^9}, {
   3.6728380121445847`*^9, 3.672838048775083*^9}, 3.67298196369242*^9, {
   3.6731840696829977`*^9, 3.6731840700485363`*^9}, {3.673184336332444*^9, 
   3.6731843630686007`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutant allele frequencies X2m", "Section",
 CellChangeTimes->{{3.6728319528344173`*^9, 3.6728319555860863`*^9}, 
   3.672837429855502*^9, {3.6731820128378468`*^9, 3.673182042178329*^9}}],

Cell["\<\
We now consider the mutant SA allele \[ScriptCapitalX]2m next to \
\[ScriptCapitalX]1 and \[ScriptCapitalX]2:\
\>", "Text",
 CellChangeTimes->{{3.67283198959264*^9, 3.672831992487815*^9}, {
   3.672832102234517*^9, 3.672832125833947*^9}, 3.672837429855732*^9, {
   3.673182059098084*^9, 3.6731820597467546`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"haplosx2m", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6728320359137793`*^9, 3.672832077698114*^9}, {
   3.67283216143755*^9, 3.672832164075441*^9}, {3.672832322605207*^9, 
   3.672832325643944*^9}, 3.672835141503418*^9, 3.6728374298561983`*^9, {
   3.673182051966835*^9, 3.6731820538921843`*^9}, {3.673183027545877*^9, 
   3.673183027770713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fovax2m", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gam", "[", 
          RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
         RowBox[{"F", "[", 
          RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hapDad", ",", "haplosx2m"}], "}"}]}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gam", "[", 
          RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
         RowBox[{"F", "[", 
          RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"hapMom", ",", "haplosx2m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hapDad", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplosx2m"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.672832145873275*^9, 3.672832171741993*^9}, {
   3.672832224204438*^9, 3.672832263888403*^9}, {3.672832355602874*^9, 
   3.672832385031159*^9}, {3.672832572309833*^9, 3.6728325740210752`*^9}, 
   3.6728374298578176`*^9, {3.673183030623486*^9, 3.673183031028515*^9}, {
   3.673184107870037*^9, 3.6731841124359207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fspermx2m", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", "haplosx2m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"hapDad", ",", 
         RowBox[{"{", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplosx2m"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.672832145873275*^9, 3.672832171741993*^9}, {
   3.672832224204438*^9, 3.672832263888403*^9}, {3.672832355602874*^9, 
   3.672832385031159*^9}, {3.67283244022805*^9, 3.672832475663526*^9}, {
   3.672832577043407*^9, 3.672832578107572*^9}, 3.6728374298590317`*^9, {
   3.673183035235697*^9, 3.673183036514279*^9}, {3.673184117403276*^9, 
   3.673184123188033*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FFx2m", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovax2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fspermx2m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6728360928824453`*^9, 3.672836165366435*^9}, {
   3.672837187926056*^9, 3.672837279427154*^9}, 3.672837429870335*^9, {
   3.672837542951679*^9, 3.6728375990198603`*^9}, {3.672837638313529*^9, 
   3.6728376461492577`*^9}, {3.6728378030499077`*^9, 3.6728378400055313`*^9}, 
   3.672940253614581*^9, {3.672999909185938*^9, 3.672999909344338*^9}, {
   3.6730032569327374`*^9, 3.673003305047267*^9}, {3.6731826998662024`*^9, 
   3.673182733048936*^9}, {3.673184165761909*^9, 3.67318416654327*^9}, {
   3.673184367710545*^9, 3.67318439223825*^9}, {3.673184478750589*^9, 
   3.673184483886722*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FFx2m", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.673184199381551*^9, 3.673184203353422*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}]},
     {
      FractionBox[
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
         RowBox[{"{", "Y", "}"}]}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "0", "0",
       "0"},
     {"0", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", "Y", "}"}]}], "]"}]}], 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.673184203662491*^9, {3.673184564983927*^9, 3.673184574405369*^9}, 
   3.673184657270198*^9, 3.673184696198457*^9, 3.673184898701082*^9, {
   3.673245571875127*^9, 3.673245591554493*^9}, 3.673247414775182*^9, 
   3.6732551209006557`*^9, 3.6732557857811127`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FF2x2m", "=", "FFx2m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x2m", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx2m", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x2m", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx2m", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x2m", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx2m", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2x2m", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FFx2m", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672940461883422*^9, 3.6729405464832067`*^9}, {
  3.673184177386672*^9, 3.673184190984395*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FF2x2m", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672996557318204*^9, 3.672996560312999*^9}, {
  3.6731847089163446`*^9, 3.6731847094359007`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"f", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptF]", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"f", "[", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptF]", "[", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]]}], 
         ")"}]}]}]},
     {
      FractionBox[
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
         RowBox[{"{", "Y", "}"}]}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}]], "0", "0",
       "0"},
     {"0", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
          RowBox[{"{", "Y", "}"}]}], "]"}]}], 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.672996560721681*^9, 3.672998590011815*^9, 3.672999913475684*^9, 
   3.6730026190457077`*^9, 3.673002660737653*^9, 3.673003277306041*^9, 
   3.6730040047976923`*^9, 3.6730075737408047`*^9, 3.673074746146531*^9, 
   3.673074909814513*^9, 3.6731144361486607`*^9, 3.673182689601304*^9, {
   3.6731847063182507`*^9, 3.673184709939246*^9}, 3.6731848987675867`*^9, 
   3.673245591604806*^9, 3.673247414819496*^9, 3.673255120959448*^9, 
   3.673255785839429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix F eigenvectors", "Subsection",
 CellChangeTimes->{{3.672992907996264*^9, 3.672992914172285*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vvalsx2m", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"vf0x2m", ",", "vf1x2m", ",", "vm0x2m", ",", "vm1x2m"}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvalsx2m", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "uf0x2m", "}"}], ",", 
     RowBox[{"{", "uf1x2m", "}"}], ",", 
     RowBox[{"{", "um0x2m", "}"}], ",", 
     RowBox[{"{", "um1x2m", "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6729924768251743`*^9, 3.67299248634032*^9}, {
  3.6729932209798737`*^9, 3.6729932374200153`*^9}, {3.67324729496625*^9, 
  3.673247313669052*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uveqsx2m", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2x2m", ".", "uvalsx2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "uf1x2m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2x2m", ".", "uvalsx2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "um0x2m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2x2m", ".", "uvalsx2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "um1x2m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx2m", ".", "FF2x2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "vf0x2m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx2m", ".", "FF2x2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "vf1x2m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx2m", ".", "FF2x2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "vm0x2m"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvalsx2m", ".", "FF2x2m"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]x2m", " ", "vm1x2m"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672997265098961*^9, 3.672997400035041*^9}, {
  3.672997460865128*^9, 3.672997461744545*^9}, {3.673001065167368*^9, 
  3.673001080867169*^9}, {3.673001947158779*^9, 3.673001947261565*^9}, {
  3.6730023657303762`*^9, 3.6730023741751127`*^9}, {3.673002428000701*^9, 
  3.673002441356019*^9}, {3.6730024792464314`*^9, 3.673002499233531*^9}, {
  3.6730026525936623`*^9, 3.673002652922413*^9}, {3.673184759426091*^9, 
  3.6731847796332283`*^9}, {3.67324732753828*^9, 3.673247360697942*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uveqs2x2m", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"uveqsx2m", ",", 
      RowBox[{"4", "\[Rule]", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"uvalsx2m", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"vvalsx2m", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "\[Equal]", 
        "1"}]}]}], "]"}], "/.", 
    RowBox[{"uf0x2m", "\[Rule]", 
     RowBox[{"1", "-", "uf1x2m", "-", "um0x2m", "-", "um1x2m"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67300251737919*^9, 3.67300255984381*^9}, 
   3.67300265643176*^9, {3.673184784773342*^9, 3.673184810226803*^9}, {
   3.673247366158203*^9, 3.673247374357914*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsolsx2m", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"uveqs2x2m", ",", 
       RowBox[{"{", 
        RowBox[{
        "uf1x2m", ",", "um0x2m", ",", "um1x2m", ",", "vf0x2m", ",", "vf1x2m", 
         ",", "vm0x2m", ",", "vm1x2m"}], "}"}]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672997413146058*^9, 3.6729974771776323`*^9}, 
   3.673002562059359*^9, {3.673184795978816*^9, 3.673184799601263*^9}, {
   3.673247376941135*^9, 3.673247386692705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsolsExplx2m", "=", 
   RowBox[{"uvsolsx2m", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673000901373358*^9, 3.673000932022674*^9}, {
  3.673184818183794*^9, 3.673184820558647*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charPolx2m", "=", 
   RowBox[{
    RowBox[{"CharacteristicPolynomial", "[", 
     RowBox[{"FF2x2m", ",", "\[Lambda]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"charPolExplx2m", "=", 
   RowBox[{"charPolx2m", "/.", 
    RowBox[{"F", "->", "\[ScriptCapitalF]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673002764942953*^9, 3.673002786526408*^9}, {
  3.6730028869619637`*^9, 3.673002914408588*^9}, {3.6730034167768917`*^9, 
  3.673003423524884*^9}, {3.6731848232662287`*^9, 3.673184831295065*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix W", "Subsection",
 CellChangeTimes->{{3.672992925371107*^9, 3.6729929265803347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wx2m", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovax2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fspermx2m", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}]}], "}"}], "/.", 
    RowBox[{"Null", "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6728360928824453`*^9, 3.672836165366435*^9}, {
   3.672837187926056*^9, 3.672837279427154*^9}, 3.672837429870335*^9, {
   3.672837542951679*^9, 3.6728375990198603`*^9}, {3.672837638313529*^9, 
   3.6728376461492577`*^9}, {3.6728378030499077`*^9, 
   3.6728378400055313`*^9}, {3.672837962210178*^9, 3.672837981624482*^9}, {
   3.6728380121445847`*^9, 3.672838048775083*^9}, 3.67298196369242*^9, {
   3.673184845691711*^9, 3.6731848905492773`*^9}, {3.67324653568963*^9, 
   3.6732465366640387`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical solving", "Section",
 CellChangeTimes->{{3.672977057403289*^9, 3.6729770616021223`*^9}, {
  3.6729793735252123`*^9, 3.672979376613474*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FFx1mexpl", "=", 
   RowBox[{"FF2x1m", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FFx2mexpl", "=", 
   RowBox[{"FF2x2m", "/.", 
    RowBox[{"F", "->", "\[ScriptCapitalF]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6729968454899406`*^9, 3.67299685872477*^9}, {
  3.6731849651525917`*^9, 3.6731849787043962`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterRes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cfds_", ",", "cmds_", ",", "hs_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"rs_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"svs_", ",", "thf_", ",", "thm_", ",", "\[Kappa]s_"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"x1s_", ",", "x2s_"}], "}"}], ",", 
    RowBox[{"{", "tend_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "tx", ",", "subsbase", ",", "subslist", ",", "ffout", ",", 
      "uv", ",", "eval", ",", "cpol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "tend"}], "]"}], ",", 
        RowBox[{"4", "+", 
         RowBox[{"Length", "[", "haplos", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "4"}], ",", "4"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "5"}], ",", "5"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subsbase", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cfd", "\[Rule]", "cfds"}], ",", 
        RowBox[{"cmd", "\[Rule]", "cmds"}], ",", 
        RowBox[{"h", "\[Rule]", "hs"}], ",", 
        RowBox[{"r", "\[Rule]", "rs"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"sv", "\[Rule]", "svs"}], ",", 
        RowBox[{
         RowBox[{"th", "[", "f", "]"}], "\[Rule]", "thf"}], ",", 
        RowBox[{
         RowBox[{"th", "[", "m", "]"}], "\[Rule]", "thm"}], ",", 
        RowBox[{"x1", "\[Rule]", "x1s"}], ",", 
        RowBox[{"x2", "\[Rule]", "x2s"}], ",", 
        RowBox[{"\[Kappa]", "->", "\[Kappa]s"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"tx", "=", "2"}], ",", 
       RowBox[{"tx", "\[LessEqual]", "tend"}], ",", 
       RowBox[{"tx", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"subslist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"haplos", "[", 
                RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"ix", ",", 
                 RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[ScriptF]", "[", 
               RowBox[{"haplos", "[", 
                RowBox[{"[", 
                 RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"ix", ",", 
                 RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
           "subsbase"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "tx"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"fovaExpl", ",", "fspermExpl"}], "]"}], "/.", 
           "subslist"}], "//", "Flatten"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffout", "=", 
      RowBox[{"FFexpl", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", 
               RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
         "subsbase"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eval", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Eigenvalues", "[", "ffout", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "eval", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"uv", "=", 
      RowBox[{"uvsolsExpl", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", "\[Rule]", "eval"}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", 
               RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
         "subsbase"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "uv"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", "\[Rule]", "eval"}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", 
               RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
         "subsbase"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"Transpose", "[", "ffout", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Eigenvectors", "[", "ffout", "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "uv", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "eval", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "data", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672977064087887*^9, 3.672977070762644*^9}, {
   3.6729771574105797`*^9, 3.6729772619247*^9}, {3.672977337630439*^9, 
   3.672977433108034*^9}, {3.672977509762248*^9, 3.6729775336708508`*^9}, {
   3.672977567518033*^9, 3.672977665959683*^9}, {3.672977723598529*^9, 
   3.672977835121368*^9}, {3.672977866533164*^9, 3.67297800535069*^9}, 
   3.6729781011849937`*^9, {3.67297814625066*^9, 3.67297817870649*^9}, {
   3.67297820951271*^9, 3.6729782267895823`*^9}, {3.672978278338504*^9, 
   3.672978285229126*^9}, {3.672978364324605*^9, 3.672978369718773*^9}, {
   3.6729820541726427`*^9, 3.672982065904419*^9}, {3.672996885449079*^9, 
   3.672997020956637*^9}, {3.6729970895379744`*^9, 3.672997091575659*^9}, {
   3.6729971235347033`*^9, 3.672997134535787*^9}, {3.672998624961905*^9, 
   3.6729986317580013`*^9}, {3.6729989189984827`*^9, 3.672998942070805*^9}, {
   3.6729990154121857`*^9, 3.672999035294465*^9}, {3.673000941021862*^9, 
   3.6730009965169077`*^9}, {3.673001114885334*^9, 3.6730011389380503`*^9}, {
   3.6730011765039043`*^9, 3.673001178547339*^9}, {3.673002807598173*^9, 
   3.673002872723709*^9}, {3.6730029201648684`*^9, 3.673002995655232*^9}, {
   3.673005727351565*^9, 3.673005736066675*^9}, {3.673007210256049*^9, 
   3.6730072474493113`*^9}, {3.673007314972084*^9, 3.673007368802058*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"iterRes", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.85"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"-", "2"}], ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", "400", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6729776682935658`*^9, 3.672977701955155*^9}, {
   3.672978181660576*^9, 3.672978239303278*^9}, {3.672979529445166*^9, 
   3.6729795509709*^9}, {3.672981900181178*^9, 3.67298190040022*^9}, {
   3.672982132068437*^9, 3.672982150310956*^9}, {3.6729851023814793`*^9, 
   3.6729851025398283`*^9}, {3.6729970475339527`*^9, 3.67299704768305*^9}, {
   3.672997110162573*^9, 3.6729971104191093`*^9}, {3.672998634978409*^9, 
   3.672998639114291*^9}, 3.673003327580894*^9, 3.673005094442788*^9, {
   3.6730053302230387`*^9, 3.673005351566833*^9}, {3.6730055581718073`*^9, 
   3.673005559651506*^9}, {3.6730056614087877`*^9, 3.6730056615371237`*^9}, {
   3.6730073855786047`*^9, 3.673007386180263*^9}, {3.673007425045146*^9, 
   3.673007426931168*^9}, {3.6730091077526073`*^9, 3.673009127696206*^9}, {
   3.6730091891009903`*^9, 3.673009226042317*^9}, {3.6730106226565742`*^9, 
   3.673010631207964*^9}, {3.6730106634690332`*^9, 3.673010678720584*^9}, {
   3.6730771431355*^9, 3.673077155382883*^9}, {3.6731144523464003`*^9, 
   3.673114489768578*^9}}],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "FFexpl", "]"}]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}, 3.6731144485177097`*^9, 
   3.673114498730009*^9, 3.673247425379239*^9, 3.673255132638533*^9, 
   3.67325579644709*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(W \[LeftDoubleBracket] \
\\(\\(1, 1\\)\\) \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of \
object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.673247425402247*^9, 3.673255132702983*^9, 
  3.6732557964813232`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({uvsolsExpl}\\)\[NoBreak] is neither a \
list of replacement rules nor a valid dispatch table, and so cannot be used \
for replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\", ButtonNote -> \
\\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.673247425402247*^9, 3.673255132702983*^9, 
  3.6732557965063953`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/.", 
  "\[VeryThinSpace]", "uvsolsExpl"}]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}, 3.6731144485177097`*^9, 
   3.673114498730009*^9, 3.673247425379239*^9, 3.673255132638533*^9, 
   3.673255796507351*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Eigenvectors", "[", 
   RowBox[{"Transpose", "[", "FFexpl", "]"}], "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}, 3.6731144485177097`*^9, 
   3.673114498730009*^9, 3.673247425379239*^9, 3.673255132638533*^9, 
   3.673255796507841*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Eigenvectors", "[", "FFexpl", "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}, 3.6731144485177097`*^9, 
   3.673114498730009*^9, 3.673247425379239*^9, 3.673255132638533*^9, 
   3.673255796508662*^9}],

Cell[BoxData["uvsolsExpl"], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}, 3.6731144485177097`*^9, 
   3.673114498730009*^9, 3.673247425379239*^9, 3.673255132638533*^9, 
   3.673255796509431*^9}],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "FFexpl", "]"}]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}, 3.6731144485177097`*^9, 
   3.673114498730009*^9, 3.673247425379239*^9, 3.673255132638533*^9, 
   3.673255796510137*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["haplos"], "Input",
 CellChangeTimes->{{3.6731145601686687`*^9, 3.673114560782486*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
   RowBox[{"{", "Y", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.673114561235165*^9, 3.6732474255126266`*^9, 
  3.673255132822801*^9, 3.673255796568572*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673007272949192*^9, 3.673007275182843*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"1", ";;", "9"}], ",", "400"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.673005567177265*^9, 3.673005570815073*^9}, {
  3.673005667300487*^9, 3.673005667869763*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.10147459318666457`", ",", "0.10147459318666471`", ",", 
   "0.3985254068133349`", ",", "0.39852540681333565`", ",", 
   "0.06668669595308412`", ",", "0.0666866959530842`", ",", 
   "0.3116326168797567`", ",", "0.3116326168797572`", ",", 
   "0.24336137433431784`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6730055712163897`*^9, 3.6730056684218473`*^9, 3.673007585276458*^9, 
   3.673009145717849*^9, {3.6730091974834843`*^9, 3.673009242083621*^9}, {
   3.6730106466163597`*^9, 3.673010694331554*^9}, 3.6730747589109497`*^9, 
   3.673074926283709*^9, 3.673074960187661*^9, 3.673114448770329*^9, 
   3.673114505677724*^9, 3.673247425552417*^9, 3.67325513285108*^9, 
   3.673255796594893*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "400"}], "]"}], "]"}], "//", 
  "Total"}]], "Input",
 CellChangeTimes->{{3.673114520663048*^9, 3.673114535818911*^9}, 
   3.673114568099225*^9}],

Cell[BoxData["0.7970508136266705`"], "Output",
 CellChangeTimes->{{3.673114529035102*^9, 3.673114536148007*^9}, 
   3.673114568569542*^9, 3.6732474255864067`*^9, 3.673255132872218*^9, 
   3.673255796615272*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to C", "Section",
 CellChangeTimes->{{3.672985837060911*^9, 3.6729858383888702`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"directory", "=", 
  RowBox[{
  "$HomeDirectory", "<>", 
   "\"\</Projects/drive/src/numerical/drive_continuous/\>\""}]}]], "Input",
 CellChangeTimes->{{3.673255038067727*^9, 3.6732550466863737`*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\"\
\>"], "Output",
 CellChangeTimes->{3.673255052712729*^9, 3.673255132889412*^9, 
  3.673255796635762*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Recursions of resident", "Subsection",
 CellChangeTimes->{{3.673004574014861*^9, 3.673004578501451*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<expressions_resident.txt\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.672985844827239*^9, 3.672985873622394*^9}, {
  3.672986600729083*^9, 3.672986601897593*^9}, {3.6732550443667*^9, 
  3.673255058526843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.672985916394869*^9, 3.672985921945785*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tx", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"CForm", "[", 
    RowBox[{"x", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalX]1", "\[Rule]", "X1"}], ",", 
       RowBox[{"\[ScriptCapitalX]2", "\[Rule]", "X2"}], ",", 
       RowBox[{"\[ScriptCapitalX]1m", "\[Rule]", "X1"}], ",", 
       RowBox[{"\[ScriptCapitalX]2m", "\[Rule]", "X2"}], ",", 
       RowBox[{"f", "\[Rule]", "ff"}], ",", 
       RowBox[{"\[ScriptF]", "\[Rule]", "fm"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672985968228217*^9, 3.672985986649579*^9}, {
  3.672986376415182*^9, 3.672986416108233*^9}, {3.672986489746086*^9, 
  3.672986504470744*^9}}],

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"ix", "=", "1"}], ",", 
   RowBox[{"ix", "\[LessEqual]", "4"}], ",", 
   RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"f", "[", 
        RowBox[{"haplos", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\<_tplus1 = \>\"", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"fovaExpl", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"ix", "=", "1"}], ",", 
   RowBox[{"ix", "\[LessEqual]", "5"}], ",", 
   RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"\[ScriptF]", "[", 
        RowBox[{"haplos", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\<_tplus1 = \>\"", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"fspermExpl", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.672985885635339*^9, 3.672985955282421*^9}, {
  3.672985990402998*^9, 3.67298609359571*^9}, {3.6729861437521143`*^9, 
  3.672986150525977*^9}, {3.672986261430307*^9, 3.672986266650399*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "str"}], "]"}]], "Input",
 CellChangeTimes->{{3.672986333055067*^9, 3.672986349308429*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
expressions_resident.txt\"\>"], "Output",
 CellChangeTimes->{
  3.6729863499520884`*^9, 3.672986420774602*^9, 3.6729865134247417`*^9, 
   3.67298660756936*^9, 3.67298725916017*^9, 3.672990866968713*^9, {
   3.67299344824937*^9, 3.672993459001214*^9}, 3.6729935067496643`*^9, {
   3.6729940099276752`*^9, 3.672994023355919*^9}, 3.672996249446136*^9, 
   3.672997553029632*^9, 3.6729985966356907`*^9, 3.673004015515016*^9, 
   3.673004676421116*^9, 3.673007585354643*^9, 3.673247425710657*^9, 
   3.67325513299854*^9, 3.673255796714376*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix F for X1m", "Subsection",
 CellChangeTimes->{{3.673004595404806*^9, 3.673004596787981*^9}, {
  3.673197174194662*^9, 3.67319717593749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<expressions_fmatrix_x1m.txt\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6730042895755157`*^9, 3.6730043087478724`*^9}, {
  3.6730044968919992`*^9, 3.67300449738866*^9}, {3.673198440842923*^9, 
  3.673198441706193*^9}, {3.673255070949298*^9, 3.673255071853698*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FF2x1mExpl", "=", 
   RowBox[{"FF2x1m", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673004253856111*^9, 3.673004267570982*^9}, {
  3.673198446057447*^9, 3.6731984493991127`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<double data[] = {\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.6730043275876417`*^9, 3.673004350890863*^9}, 
   3.67300450195546*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "FF2x1mExpl", "]"}]}], ",", 
    RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iy", "=", "1"}], ",", 
       RowBox[{"iy", "\[LessEqual]", 
        RowBox[{"Length", "[", "FF2x1mExpl", "]"}]}], ",", 
       RowBox[{"iy", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", 
          RowBox[{"tx", "[", 
           RowBox[{"FF2x1mExpl", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", "iy"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<,\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<};\>\""}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673004273291305*^9, 3.673004335413179*^9}, {
  3.673004373750905*^9, 3.673004511173375*^9}, {3.673004552513576*^9, 
  3.673004552990168*^9}, {3.673198454188052*^9, 3.673198457558138*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"file", ",", "str"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.673004513751124*^9, 3.67300452042773*^9}, {
  3.673198468639615*^9, 3.67319846913693*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix F for X2m", "Subsection",
 CellChangeTimes->{{3.673004595404806*^9, 3.673004596787981*^9}, {
  3.673197174194662*^9, 3.67319717593749*^9}, {3.6731985517035627`*^9, 
  3.673198579503624*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<expressions_fmatrix_x2m.txt\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6730042895755157`*^9, 3.6730043087478724`*^9}, {
  3.6730044968919992`*^9, 3.67300449738866*^9}, {3.673198440842923*^9, 
  3.673198441706193*^9}, {3.673198582196815*^9, 3.6731985823063583`*^9}, {
  3.673255078830736*^9, 3.673255079692792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FF2x2mExpl", "=", 
   RowBox[{"FF2x2m", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673004253856111*^9, 3.673004267570982*^9}, {
  3.673198446057447*^9, 3.6731984493991127`*^9}, {3.673198584526835*^9, 
  3.6731985869776983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<double data[] = {\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.6730043275876417`*^9, 3.673004350890863*^9}, 
   3.67300450195546*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "FF2x2mExpl", "]"}]}], ",", 
    RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iy", "=", "1"}], ",", 
       RowBox[{"iy", "\[LessEqual]", 
        RowBox[{"Length", "[", "FF2x2mExpl", "]"}]}], ",", 
       RowBox[{"iy", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", 
          RowBox[{"tx", "[", 
           RowBox[{"FF2x2mExpl", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", "iy"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<,\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<};\>\""}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673004273291305*^9, 3.673004335413179*^9}, {
  3.673004373750905*^9, 3.673004511173375*^9}, {3.673004552513576*^9, 
  3.673004552990168*^9}, {3.673198454188052*^9, 3.673198457558138*^9}, {
  3.67319859023284*^9, 3.673198593761396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"file", ",", "str"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.673004513751124*^9, 3.67300452042773*^9}, {
  3.673198468639615*^9, 3.67319846913693*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvectors x1m", "Subsection",
 CellChangeTimes->{{3.673004610788908*^9, 3.673004613139804*^9}, {
  3.673199752209244*^9, 3.673199752872807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<expressions_eigenvecs_x1m.txt\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.672990455726048*^9, {3.6729930032529*^9, 3.6729930048201523`*^9}, {
   3.6731992524687843`*^9, 3.673199253475934*^9}, {3.673255085068879*^9, 
   3.673255086004331*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<uf0x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{
      RowBox[{"1", "-", "uf1x1m", "-", "um0x1m", "-", "um1x1m"}], "/.", 
      "uvsolsExplx1m"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<uf1x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"uf1x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<um0x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"um0x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<um1x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"um1x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vf0x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vf0x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vf1x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vf1x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vm0x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vm0x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vm1x1m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vm1x1m", "/.", "uvsolsExplx1m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672990465144394*^9, 3.672990468715304*^9}, 
   3.672990524297229*^9, {3.6729930516807737`*^9, 3.672993205777204*^9}, {
   3.672993431903842*^9, 3.672993442031107*^9}, {3.6729934948216467`*^9, 
   3.672993503437038*^9}, {3.67299395393217*^9, 3.672993969081656*^9}, 
   3.672994020307065*^9, {3.672997510997814*^9, 3.672997542870255*^9}, {
   3.6730033810944633`*^9, 3.673003402138884*^9}, {3.673003451165786*^9, 
   3.673003473734568*^9}, {3.673199256463022*^9, 3.6731992681624413`*^9}, 
   3.673199738191297*^9, {3.6732472041573133`*^9, 3.67324721963361*^9}, {
   3.673255756932117*^9, 3.673255766470175*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "str"}], "]"}]], "Input",
 CellChangeTimes->{{3.67299313334114*^9, 3.672993133948143*^9}, {
  3.672993513779422*^9, 3.672993519051578*^9}, {3.672997545699383*^9, 
  3.672997547828822*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
expressions_eigenvecs_x1m.txt\"\>"], "Output",
 CellChangeTimes->{{3.6729931343917913`*^9, 3.672993148902034*^9}, {
   3.672993448301614*^9, 3.6729934590355053`*^9}, {3.672993506860765*^9, 
   3.6729935193915443`*^9}, 3.672994023548417*^9, 3.672996249700584*^9, {
   3.672997546277689*^9, 3.6729975534440928`*^9}, 3.672998597131549*^9, 
   3.673004016247077*^9, 3.6730046772134132`*^9, 3.673007585779819*^9, 
   3.673247426201137*^9, 3.673255133517913*^9, 3.6732557971796923`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvectors x2m", "Subsection",
 CellChangeTimes->{{3.673004610788908*^9, 3.673004613139804*^9}, {
  3.673199752209244*^9, 3.673199752872807*^9}, {3.673246428072732*^9, 
  3.673246428561071*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<expressions_eigenvecs_x2m.txt\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.672990455726048*^9, {3.6729930032529*^9, 3.6729930048201523`*^9}, {
   3.6731992524687843`*^9, 3.673199253475934*^9}, {3.673246431197301*^9, 
   3.673246431333503*^9}, {3.673255090780333*^9, 3.673255091668741*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<uf0x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{
      RowBox[{"1", "-", "uf1x2m", "-", "um0x2m", "-", "um1x2m"}], "/.", 
      "uvsolsExplx2m"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<uf1x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"uf1x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<um0x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"um0x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<um1x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"um1x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vf0x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vf0x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vf1x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vf1x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vm0x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vm0x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vm1x2m = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vm1x2m", "/.", "uvsolsExplx2m"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672990465144394*^9, 3.672990468715304*^9}, 
   3.672990524297229*^9, {3.6729930516807737`*^9, 3.672993205777204*^9}, {
   3.672993431903842*^9, 3.672993442031107*^9}, {3.6729934948216467`*^9, 
   3.672993503437038*^9}, {3.67299395393217*^9, 3.672993969081656*^9}, 
   3.672994020307065*^9, {3.672997510997814*^9, 3.672997542870255*^9}, {
   3.6730033810944633`*^9, 3.673003402138884*^9}, {3.673003451165786*^9, 
   3.673003473734568*^9}, {3.673199256463022*^9, 3.6731992681624413`*^9}, 
   3.673199738191297*^9, {3.673246433359311*^9, 3.6732464387166767`*^9}, {
   3.6732472222425833`*^9, 3.6732472565477962`*^9}, {3.673255768519845*^9, 
   3.673255774571347*^9}, {3.6732559428865356`*^9, 3.673255948945498*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "str"}], "]"}]], "Input",
 CellChangeTimes->{{3.67299313334114*^9, 3.672993133948143*^9}, {
  3.672993513779422*^9, 3.672993519051578*^9}, {3.672997545699383*^9, 
  3.672997547828822*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
expressions_eigenvecs_x2m.txt\"\>"], "Output",
 CellChangeTimes->{{3.6729931343917913`*^9, 3.672993148902034*^9}, {
   3.672993448301614*^9, 3.6729934590355053`*^9}, {3.672993506860765*^9, 
   3.6729935193915443`*^9}, 3.672994023548417*^9, 3.672996249700584*^9, {
   3.672997546277689*^9, 3.6729975534440928`*^9}, 3.672998597131549*^9, 
   3.673004016247077*^9, 3.6730046772134132`*^9, 3.673007585779819*^9, 
   3.673247426961803*^9, 3.673255134043089*^9, 3.67325579770753*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutant selection gradient", "Subsection",
 CellChangeTimes->{{3.673004667505797*^9, 3.673004671888569*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"selgradx1m", "=", 
    RowBox[{"\"\<x1mtplus1 = x1 + \>\"", "<>", 
     RowBox[{"tx", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vvalsx1m", ".", "Wx1m", ".", "uvalsx1m"}], "/", 
         RowBox[{"(", 
          RowBox[{"vvalsx1m", ".", "uvalsx1m"}], ")"}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "<>", 
     "\"\<;\\n\\n\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selgradx2m", "=", 
   RowBox[{"\"\<x2mtplus1 = x2 + \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vvalsx2m", ".", "Wx2m", ".", "uvalsx2m"}], "/", 
        RowBox[{"(", 
         RowBox[{"vvalsx2m", ".", "uvalsx2m"}], ")"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6729942216310663`*^9, 3.6729942637092257`*^9}, {
   3.6729943090373783`*^9, 3.6729943524509974`*^9}, {3.672994435326788*^9, 
   3.672994491650855*^9}, {3.673246683807229*^9, 3.6732467320061207`*^9}, {
   3.6732467742523937`*^9, 3.673246780651985*^9}, {3.673246813700365*^9, 
   3.673246819075652*^9}, {3.673247258024132*^9, 3.6732472802890177`*^9}, {
   3.67324743594454*^9, 3.6732474601449842`*^9}, 3.673255014081518*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<selgrad_x1m.txt\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "selgradx1m"}], "]"}]}], "Input",
 CellChangeTimes->{{3.672994454447772*^9, 3.6729944550906353`*^9}, {
   3.672994525265111*^9, 3.672994550952198*^9}, 3.673246686784286*^9, {
   3.673247469343604*^9, 3.673247474413905*^9}, {3.673255017713129*^9, 
   3.673255024152886*^9}, {3.6732551011812057`*^9, 3.6732551025642157`*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
selgrad_x1m.txt\"\>"], "Output",
 CellChangeTimes->{3.673255134115183*^9, 3.673255797802205*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"directory", "<>", "\"\<selgrad_x2m.txt\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "selgradx2m"}], "]"}]}], "Input",
 CellChangeTimes->{{3.673255029128619*^9, 3.673255032856542*^9}, {
  3.6732551070196953`*^9, 3.67325510745245*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
selgrad_x2m.txt\"\>"], "Output",
 CellChangeTimes->{3.672994455623229*^9, 3.6729944929456053`*^9, 
  3.6729945542709217`*^9, 3.6729962497492332`*^9, 3.672997553487974*^9, 
  3.672998597232205*^9, 3.6730040162992477`*^9, 3.673004677263309*^9, 
  3.673007585939766*^9, 3.673247427237339*^9, 3.673247485013238*^9, 
  3.673255134144548*^9, 3.6732557978315496`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1879, 1065},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 170, 2, 119, "Section"],
Cell[752, 26, 138, 2, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[927, 33, 147, 2, 119, "Section"],
Cell[1077, 37, 126, 1, 69, "Text"],
Cell[CellGroupData[{
Cell[1228, 42, 497, 13, 70, "Input"],
Cell[1728, 57, 1045, 21, 70, "Output"]
}, Open  ]],
Cell[2788, 81, 301, 6, 69, "Text"],
Cell[3092, 89, 2707, 67, 421, "Input"],
Cell[5802, 158, 128, 1, 69, "Text"],
Cell[5933, 161, 1781, 47, 360, "Input"],
Cell[7717, 210, 113, 1, 69, "Text"],
Cell[CellGroupData[{
Cell[7855, 215, 675, 19, 70, "Input"],
Cell[8533, 236, 19262, 555, 70, "Output"]
}, Open  ]],
Cell[27810, 794, 207, 3, 69, "Text"],
Cell[28020, 799, 3467, 90, 753, "Input"],
Cell[CellGroupData[{
Cell[31512, 893, 806, 24, 70, "Input"],
Cell[32321, 919, 38277, 993, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70635, 1917, 452, 10, 70, "Input"],
Cell[71090, 1929, 786, 12, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[71925, 1947, 170, 2, 72, "Section"],
Cell[72098, 1951, 99, 1, 69, "Text"],
Cell[72200, 1954, 1845, 49, 120, "Input"],
Cell[74048, 2005, 102, 1, 69, "Text"],
Cell[74153, 2008, 1191, 32, 70, "Input"],
Cell[75347, 2042, 105, 1, 69, "Text"],
Cell[75455, 2045, 913, 25, 70, "Input"],
Cell[76371, 2072, 191, 4, 69, "Text"],
Cell[76565, 2078, 418, 12, 120, "Input"],
Cell[CellGroupData[{
Cell[77008, 2094, 132, 2, 70, "Input"],
Cell[77143, 2098, 639, 9, 70, "Output"]
}, Open  ]],
Cell[77797, 2110, 92, 1, 70, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[77926, 2116, 192, 2, 72, "Section"],
Cell[78121, 2120, 262, 3, 45, "Text"],
Cell[78386, 2125, 533, 13, 45, "Input"],
Cell[78922, 2140, 1583, 41, 75, "Input"],
Cell[80508, 2183, 1089, 27, 45, "Input"],
Cell[81600, 2212, 259, 5, 45, "Text"],
Cell[81862, 2219, 1841, 47, 119, "Input"],
Cell[83706, 2268, 1015, 25, 45, "Input"],
Cell[84724, 2295, 1043, 26, 191, "Input"],
Cell[85770, 2323, 7797, 211, 510, "Input"],
Cell[93570, 2536, 1929, 60, 162, "Input"],
Cell[CellGroupData[{
Cell[95524, 2600, 183, 3, 45, "Input"],
Cell[95710, 2605, 9678, 265, 212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105425, 2875, 109, 1, 65, "Subsection"],
Cell[105537, 2878, 633, 17, 75, "Input"],
Cell[106173, 2897, 2608, 62, 220, "Input"],
Cell[108784, 2961, 996, 26, 45, "Input"],
Cell[109783, 2989, 567, 14, 45, "Input"],
Cell[110353, 3005, 274, 6, 45, "Input"],
Cell[110630, 3013, 629, 14, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111296, 3032, 98, 1, 65, "Subsection"],
Cell[111397, 3035, 8083, 214, 510, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119529, 3255, 192, 2, 119, "Section"],
Cell[119724, 3259, 322, 6, 45, "Text"],
Cell[120049, 3267, 585, 14, 45, "Input"],
Cell[120637, 3283, 1584, 41, 75, "Input"],
Cell[122224, 3326, 1081, 27, 45, "Input"],
Cell[123308, 3355, 7898, 213, 510, "Input"],
Cell[CellGroupData[{
Cell[131231, 3572, 129, 2, 45, "Input"],
Cell[131363, 3576, 12569, 349, 206, "Output"]
}, Open  ]],
Cell[143947, 3928, 1927, 60, 162, "Input"],
Cell[CellGroupData[{
Cell[145899, 3992, 183, 3, 45, "Input"],
Cell[146085, 3997, 9559, 264, 212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155681, 4266, 109, 1, 65, "Subsection"],
Cell[155793, 4269, 632, 17, 75, "Input"],
Cell[156428, 4288, 2456, 60, 220, "Input"],
Cell[158887, 4350, 922, 25, 45, "Input"],
Cell[159812, 4377, 565, 14, 45, "Input"],
Cell[160380, 4393, 274, 6, 45, "Input"],
Cell[160657, 4401, 578, 13, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161272, 4419, 98, 1, 65, "Subsection"],
Cell[161373, 4422, 8080, 214, 510, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169502, 4642, 155, 2, 119, "Section"],
Cell[169660, 4646, 425, 11, 75, "Input"],
Cell[170088, 4659, 9745, 238, 713, "Input"],
Cell[CellGroupData[{
Cell[179858, 4901, 1525, 29, 45, "Input"],
Cell[181386, 4932, 1184, 17, 33, "Print"],
Cell[182573, 4951, 571, 12, 34, "Message"],
Cell[183147, 4965, 587, 12, 34, "Message"],
Cell[CellGroupData[{
Cell[183759, 4981, 1289, 20, 33, "Print"],
Cell[185051, 5003, 1286, 21, 33, "Print"],
Cell[186340, 5026, 1249, 20, 33, "Print"],
Cell[187592, 5048, 1152, 16, 33, "Print"],
Cell[188747, 5066, 1185, 17, 33, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[189981, 5089, 100, 1, 45, "Input"],
Cell[190084, 5092, 506, 13, 45, "Output"]
}, Open  ]],
Cell[190605, 5108, 92, 1, 45, "Input"],
Cell[CellGroupData[{
Cell[190722, 5113, 246, 6, 45, "Input"],
Cell[190971, 5121, 737, 14, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191745, 5140, 283, 9, 45, "Input"],
Cell[192031, 5151, 210, 3, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[192290, 5160, 98, 1, 119, "Section"],
Cell[CellGroupData[{
Cell[192413, 5165, 223, 5, 45, "Input"],
Cell[192639, 5172, 183, 3, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192859, 5180, 110, 1, 65, "Subsection"],
Cell[192972, 5183, 299, 7, 45, "Input"],
Cell[193274, 5192, 142, 3, 45, "Input"],
Cell[193419, 5197, 724, 17, 45, "Input"],
Cell[194146, 5216, 1459, 37, 191, "Input"],
Cell[CellGroupData[{
Cell[195630, 5257, 153, 3, 45, "Input"],
Cell[195786, 5262, 615, 9, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196450, 5277, 152, 2, 65, "Subsection"],
Cell[196605, 5281, 355, 7, 45, "Input"],
Cell[196963, 5290, 270, 6, 45, "Input"],
Cell[197236, 5298, 186, 4, 45, "Input"],
Cell[197425, 5304, 1280, 31, 220, "Input"],
Cell[198708, 5337, 219, 5, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198964, 5347, 203, 3, 65, "Subsection"],
Cell[199170, 5352, 406, 8, 45, "Input"],
Cell[199579, 5362, 321, 7, 45, "Input"],
Cell[199903, 5371, 186, 4, 45, "Input"],
Cell[200092, 5377, 1328, 32, 220, "Input"],
Cell[201423, 5411, 219, 5, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201679, 5421, 153, 2, 65, "Subsection"],
Cell[201835, 5425, 335, 8, 45, "Input"],
Cell[202173, 5435, 2514, 59, 249, "Input"],
Cell[CellGroupData[{
Cell[204712, 5498, 250, 5, 45, "Input"],
Cell[204965, 5505, 557, 7, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[205571, 5518, 202, 3, 65, "Subsection"],
Cell[205776, 5523, 381, 8, 45, "Input"],
Cell[206160, 5533, 2617, 60, 249, "Input"],
Cell[CellGroupData[{
Cell[208802, 5597, 250, 5, 45, "Input"],
Cell[209055, 5604, 554, 7, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209658, 5617, 113, 1, 65, "Subsection"],
Cell[209774, 5620, 1411, 34, 104, "Input"],
Cell[CellGroupData[{
Cell[211210, 5658, 515, 10, 75, "Input"],
Cell[211728, 5670, 173, 2, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211938, 5677, 341, 8, 75, "Input"],
Cell[212282, 5687, 437, 6, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
