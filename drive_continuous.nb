(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    182118,       5000]
NotebookOptionsPosition[    176420,       4818]
NotebookOutlinePosition[    176776,       4834]
CellTagsIndexPosition[    176733,       4831]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Drive model - continuous evolution", "Section",
 CellChangeTimes->{{3.672823773140544*^9, 3.672823774861123*^9}, {
  3.6728238536380167`*^9, 3.672823874083127*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.67282387608633*^9, 3.672823891420663*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model Setup", "Section",
 CellChangeTimes->{{3.672824021459476*^9, 3.672824027330594*^9}, {
  3.6728247326750298`*^9, 3.672824734241405*^9}}],

Cell["Setup haplotypes and essential functions", "Text",
 CellChangeTimes->{{3.6728243871626863`*^9, 3.6728243938718777`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"haplos", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
    RowBox[{"{", "Y", "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.67282403676058*^9, 3.6728241935434504`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
   RowBox[{"{", "Y", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.672824159234543*^9, 3.6728242344383802`*^9, 
  3.672828265075212*^9, 3.672829960170866*^9, 3.672832761342641*^9, 
  3.672934994718956*^9, 3.672977137273571*^9, 3.6729783045496883`*^9, 
  3.672981929286232*^9, 3.6729819657746363`*^9, 3.672982069303585*^9, 
  3.67298510478402*^9, 3.672993457681273*^9, 3.672998589479887*^9, 
  3.6730040036914663`*^9, 3.673007573181478*^9, 3.6730747454758587`*^9, 
  3.673074909164501*^9}]
}, Open  ]],

Cell["\<\
Viability selection based on the SA locus, making use of the global variables \
that specify the allelic \[OpenCurlyQuote]phenotypes\[CloseCurlyQuote] x1 and \
x2.\
\>", "Text",
 CellChangeTimes->{{3.672824433743085*^9, 3.672824441299214*^9}, {
  3.672825032444066*^9, 3.67282504969109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"geno", ",", "z", ",", "val", ",", "sex"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"geno", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sex", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "0"}], ",", "f", 
        ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "determine", " ", "phenotype", " ", "based", " ", "on", " ", "the", 
        " ", "global", " ", "allelic", " ", "phenotypes", " ", "for", " ", 
        "the", " ", "SA", " ", "locus"}], ",", " ", 
       RowBox[{
        RowBox[{"x1", " ", "&"}], " ", "x2"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]1"}], "]"}], "x1"}], "+", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]2"}], "]"}], "x2"}], "+", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]1m"}], "]"}], "x1m"}], "+", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"geno", ",", "\[ScriptCapitalX]2m"}], "]"}], "x2m"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"val", "=", 
      RowBox[{
       RowBox[{"\[Kappa]", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z", "-", 
              RowBox[{"th", "[", "sex", "]"}]}], ")"}], "2"]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            SuperscriptBox["sv", "2"]}], ")"}]}], "]"}]}], "+", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Kappa]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "val", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672824283809176*^9, 3.672824332894318*^9}, {
  3.672824369325102*^9, 3.6728243711429977`*^9}, {3.672824820386063*^9, 
  3.672824847474188*^9}, {3.672824917902295*^9, 3.672824929994944*^9}, {
  3.6728249692368383`*^9, 3.6728250619381742`*^9}, {3.672825521644678*^9, 
  3.672825541725829*^9}, {3.672827428154134*^9, 3.672827450873543*^9}, {
  3.672831717782721*^9, 3.67283173815593*^9}, {3.6728327554735622`*^9, 
  3.672832757439049*^9}, {3.672982021563662*^9, 3.672982034523773*^9}}],

Cell["Viability selection based on the drive locus", "Text",
 CellChangeTimes->{{3.6728244438474607`*^9, 3.672824451206585*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"geno", ",", "z", ",", "val", ",", "sex"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"geno", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sex", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "0"}], ",", "f", 
        ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"geno", ",", "Xd"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "sex", "}"}], ",", "f"}], "]"}], "\[Equal]", "0"}], 
       ",", 
       RowBox[{"Return", "[", 
        RowBox[{"1", "-", 
         RowBox[{"z", "*", "cmd"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"h", " ", "cfd"}]}], ",", 
        RowBox[{"z", "\[Equal]", "2"}], ",", 
        RowBox[{"1", "-", "cfd"}], ",", 
        RowBox[{"z", "\[Equal]", "0"}], ",", "1"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6728246765310383`*^9, 3.672824728348208*^9}, {
  3.672825069807102*^9, 3.672825227216508*^9}, {3.672825260031679*^9, 
  3.6728253417973967`*^9}, {3.672825434680388*^9, 3.67282543482504*^9}, {
  3.672827458687368*^9, 3.672827467816565*^9}}],

Cell["Check with a table of values:", "Text",
 CellChangeTimes->{{3.6728263716180267`*^9, 3.672826379937607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hapi", ",", "hapj", ",", "sex", ",", 
        RowBox[{"y", "[", 
         RowBox[{"hapi", ",", "hapj", ",", "sex"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"hapi", ",", "haplos"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"hapj", ",", "haplos"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"sex", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "m"}], "}"}]}], "}"}]}], "]"}], ",", "2"}], "]"}], 
  "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672825366979681*^9, 3.6728254854754667`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "f"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", 
       RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", "m"}], 
       "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", "Y", "}"}], "f", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "f"}], "]"}]},
     {
      RowBox[{"{", "Y", "}"}], 
      RowBox[{"{", "Y", "}"}], "m", 
      RowBox[{"y", "[", 
       RowBox[{
        RowBox[{"{", "Y", "}"}], ",", 
        RowBox[{"{", "Y", "}"}], ",", "m"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.672825420873879*^9, 3.672825485882141*^9}, 
   3.672828265135356*^9, 3.672829960238817*^9, 3.6728327614269943`*^9, 
   3.672934994894232*^9, 3.672977137331873*^9, 3.672978304612455*^9, 
   3.672981929370967*^9, 3.6729819658473597`*^9, 3.672982069387019*^9, 
   3.672985104846345*^9, 3.672993457725398*^9, 3.672998589530889*^9, 
   3.673004003822454*^9, 3.673007573235676*^9, 3.6730747455353622`*^9, 
   3.673074909223282*^9}]
}, Open  ]],

Cell["Gamete production function", "Text",
 CellChangeTimes->{{3.672826463744356*^9, 3.672826464542344*^9}, {
  3.67282654546624*^9, 3.672826547121277*^9}, {3.6728267548620462`*^9, 
  3.672826760951519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gam", "[", 
    RowBox[{"hapMom_", ",", "hapDad_", ",", "hapGoal_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "geno", ",", "sex", ",", "hapNoRec", ",", "hapRec", ",", "drive"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"geno", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sex", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "0"}], ",", "f", 
         ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drive", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"hapMom", ",", "Xd"}], "]"}], ">", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"hapGoal", ",", "Xd"}], "]"}], ">", "0"}], ",", "k", ",", 
           RowBox[{"1", "-", "k"}]}], "]"}], ",", 
         FractionBox["1", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hapNoRec", "=", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", "hapDad"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"hapDad", ",", "Y"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"drive", " ", 
          RowBox[{"Count", "[", 
           RowBox[{"hapNoRec", ",", "hapGoal"}], "]"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "only", " ", "deal", " ", "with", " ", "females", " ", "from", " ", 
        "now", " ", "on"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hapRec", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"hapMom", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"hapDad", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"hapDad", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"hapMom", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"Count", "[", 
           RowBox[{"hapNoRec", ",", "hapGoal"}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], "r", "  ", 
          RowBox[{"Count", "[", 
           RowBox[{"hapRec", ",", "hapGoal"}], "]"}]}]}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6728267883949203`*^9, 3.672826812913519*^9}, {
  3.672827277515675*^9, 3.6728272913965282`*^9}, {3.672827324617877*^9, 
  3.672827403966061*^9}, {3.672827488291081*^9, 3.672827651553219*^9}, {
  3.672827706589932*^9, 3.6728278163652477`*^9}, {3.672828008827561*^9, 
  3.6728280917498817`*^9}, {3.672828131863368*^9, 3.672828134416112*^9}, {
  3.6728281897880287`*^9, 3.67282820716295*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mom", ",", "dad", ",", "goal", ",", 
      RowBox[{"gam", "[", 
       RowBox[{"mom", ",", "dad", ",", "goal"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mom", ",", 
      RowBox[{"haplos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dad", ",", 
      RowBox[{"haplos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"goal", ",", 
      RowBox[{"haplos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672978971550404*^9, 3.672979056788786*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          FractionBox["1", "2"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          FractionBox["1", "2"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "k"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"1", "-", "k"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["r", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox[
           RowBox[{"1", "-", "r"}], "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          FractionBox["1", "2"]},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "1"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "0"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "k"},
         {
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"{", "Y", "}"}], 
          RowBox[{"1", "-", "k"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6729789957566967`*^9, 3.672979016925849*^9}, {
   3.672979051761594*^9, 3.672979057208139*^9}, 3.672981929455317*^9, 
   3.672981965910225*^9, 3.672982069437611*^9, 3.672985104903257*^9, 
   3.672993457772422*^9, 3.672998589586214*^9, 3.673004003920895*^9, 
   3.673007573289315*^9, 3.673074745605866*^9, 3.6730749092970257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gam", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
   RowBox[{"haplos", "[", 
    RowBox[{"[", "5", "]"}], "]"}], ",", 
   RowBox[{"{", "Y", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67282806603025*^9, 3.6728281087721233`*^9}, {
  3.672828142484242*^9, 3.6728282120724573`*^9}, {3.672831175172221*^9, 
  3.672831216289475*^9}, {3.672831362690749*^9, 3.672831368233857*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", "k"}]], "Output",
 CellChangeTimes->{{3.6728281020941887`*^9, 3.6728282127444773`*^9}, 
   3.672828265219673*^9, 3.6728299602968903`*^9, {3.672831175579035*^9, 
   3.672831216673134*^9}, 3.672831368571439*^9, 3.672832761483467*^9, 
   3.672934994970273*^9, 3.67297714537659*^9, 3.6729783046307163`*^9, 
   3.672981929495921*^9, 3.67298196594368*^9, 3.672982069457142*^9, 
   3.672985104932824*^9, 3.67299345779801*^9, 3.672998589614559*^9, 
   3.6730040039766083`*^9, 3.6730075733149233`*^9, 3.6730747456323233`*^9, 
   3.673074909324101*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Resident allele frequency recursions", "Section",
 CellChangeTimes->{{3.672824742199346*^9, 3.672824746350585*^9}, {
  3.672833348135971*^9, 3.672833351895883*^9}}],

Cell["Recursion of F:", "Text",
 CellChangeTimes->{{3.6728333888061047`*^9, 3.672833391885646*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wbar", "[", "hapdad_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "hapMom", "]"}], 
      RowBox[{"\[ScriptF]", "[", "hapDad", "]"}], 
      RowBox[{"v", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}], 
      RowBox[{"y", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"hapMom", ",", 
       RowBox[{"haplos", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapDad", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"hapdad", ",", "Y"}], "]"}], ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}], ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "[", "hapMom", "]"}], 
    RowBox[{"\[ScriptF]", "[", "hapDad", "]"}], 
    RowBox[{"v", "[", 
     RowBox[{"hapMom", ",", "hapDad"}], "]"}], 
    RowBox[{
     RowBox[{"y", "[", 
      RowBox[{"hapMom", ",", "hapDad"}], "]"}], "/", 
     RowBox[{"wbar", "[", "hapDad", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672824750271644*^9, 3.672824811826009*^9}, {
  3.672825548342643*^9, 3.672825758079356*^9}, {3.672828240881497*^9, 
  3.672828247342502*^9}, {3.672833356229332*^9, 3.672833375874881*^9}, {
  3.67297860961763*^9, 3.6729786607117434`*^9}, {3.672979218479046*^9, 
  3.672979307354424*^9}, {3.67297936386596*^9, 3.672979366457499*^9}}],

Cell["Ova next generation:", "Text",
 CellChangeTimes->{{3.672830282689686*^9, 3.672830284760461*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fova", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"hapDad", ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", 
       RowBox[{"haplos", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6728298328340197`*^9, 3.672829965342061*^9}, {
  3.672829997287568*^9, 3.672829998357175*^9}, {3.672830108094942*^9, 
  3.672830108399049*^9}, {3.672830139087572*^9, 3.672830140611923*^9}, {
  3.672830302920137*^9, 3.6728303031501637`*^9}, {3.672978037299354*^9, 
  3.672978039164178*^9}}],

Cell["Sperm next generation", "Text",
 CellChangeTimes->{{3.672830287094174*^9, 3.6728302891101093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsperm", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", 
         RowBox[{"haplos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplos"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672830296943138*^9, 3.672830313774301*^9}, {
  3.672831245482638*^9, 3.6728312467555027`*^9}, {3.672831405745208*^9, 
  3.6728314260021152`*^9}}],

Cell["\<\
Substitute for the explicit recursion from parental gametes using the \
function \[ScriptCapitalF]:\
\>", "Text",
 CellChangeTimes->{{3.6728335298314533`*^9, 3.672833547862813*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fovaExpl", "=", 
   RowBox[{"fova", "/.", 
    RowBox[{"{", 
     RowBox[{"F", "->", "\[ScriptCapitalF]"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fspermExpl", "=", 
   RowBox[{"fsperm", "/.", 
    RowBox[{"{", 
     RowBox[{"F", "->", "\[ScriptCapitalF]"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672833507569139*^9, 3.6728335249861593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "fsperm", "]"}]], "Input",
 CellChangeTimes->{{3.672978007104497*^9, 3.6729780516720457`*^9}}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.672978010583929*^9, 3.672978051985186*^9}, 
   3.672978304764537*^9, 3.672978702794471*^9, 3.672979317409212*^9, 
   3.672979370780582*^9, 3.6729819296624413`*^9, 3.6729819660349407`*^9, 
   3.67298206954778*^9, 3.672985105016801*^9, 3.672993457882207*^9, 
   3.672998589703004*^9, 3.6730040041127663`*^9, 3.673007573406199*^9, 
   3.673074745722919*^9, 3.673074909415024*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673000037093449*^9, 3.673000038649267*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutant allele frequencies", "Section",
 CellChangeTimes->{{3.6728319528344173`*^9, 3.6728319555860863`*^9}, 
   3.672837429855502*^9}],

Cell["We now consider the mutant SA allele \[ScriptCapitalX]1m next to \
\[ScriptCapitalX]1 and \[ScriptCapitalX]2:", "Text",
 CellChangeTimes->{{3.67283198959264*^9, 3.672831992487815*^9}, {
   3.672832102234517*^9, 3.672832125833947*^9}, 3.672837429855732*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"haplosm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6728320359137793`*^9, 3.672832077698114*^9}, {
   3.67283216143755*^9, 3.672832164075441*^9}, {3.672832322605207*^9, 
   3.672832325643944*^9}, 3.672835141503418*^9, 3.6728374298561983`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fovam", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gam", "[", 
          RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
         RowBox[{"F", "[", 
          RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"hapMom", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hapDad", ",", "haplosm"}], "}"}]}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gam", "[", 
          RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
         RowBox[{"F", "[", 
          RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"hapMom", ",", "haplosm"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"hapDad", ",", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplosm"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672832145873275*^9, 3.672832171741993*^9}, {
   3.672832224204438*^9, 3.672832263888403*^9}, {3.672832355602874*^9, 
   3.672832385031159*^9}, {3.672832572309833*^9, 3.6728325740210752`*^9}, 
   3.6728374298578176`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsperm", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gam", "[", 
         RowBox[{"hapMom", ",", "hapDad", ",", "hapGoal"}], "]"}], 
        RowBox[{"F", "[", 
         RowBox[{"hapMom", ",", "hapDad"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"hapMom", ",", "haplosm"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"hapDad", ",", 
         RowBox[{"{", 
          RowBox[{"haplos", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"hapGoal", ",", "haplosm"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672832145873275*^9, 3.672832171741993*^9}, {
   3.672832224204438*^9, 3.672832263888403*^9}, {3.672832355602874*^9, 
   3.672832385031159*^9}, {3.67283244022805*^9, 3.672832475663526*^9}, {
   3.672832577043407*^9, 3.672832578107572*^9}, 3.6728374298590317`*^9}],

Cell["\<\
Try to approximate things as in Eq. A7 in Van Doorn & Dieckmann 2006. This is \
not mega-easy\
\>", "Text",
 CellChangeTimes->{{3.6728346973290577`*^9, 3.672834711405835*^9}, {
   3.672835903398366*^9, 3.672835906070771*^9}, 3.6728374298597383`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.672834808865695*^9, 3.6728348213639803`*^9}, 
   3.672837429862637*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalF]approx", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"hapMom", ",", "hapDad"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"x1m", "\[Rule]", "x1"}], "}"}]}], ")"}], 
     RowBox[{"\[ScriptCapitalF]", "[", 
      RowBox[{
       RowBox[{"hapMom", "/.", 
        RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}]}], ",", 
       RowBox[{"hapDad", "/.", 
        RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}]}]}], 
      "]"}]], ")"}], 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"hapMom", "/.", 
      RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}]}], ",", 
     RowBox[{"hapDad", "/.", 
      RowBox[{"\[ScriptCapitalX]1m", "->", "\[ScriptCapitalX]1"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.672834828971525*^9, 3.6728349598282557`*^9}, {
   3.672835000598819*^9, 3.672835000976489*^9}, {3.672835053048051*^9, 
   3.672835096381859*^9}, 3.672835172112982*^9, 3.67283742986301*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalF]approx2", "[", 
   RowBox[{"hapMom_", ",", "hapDad_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[ScriptCapitalF]", "[", 
       RowBox[{"hapMom", ",", "hapDad"}], "]"}], ",", "x1m"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"x1m", "\[Rule]", "x1"}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.672834828971525*^9, 3.6728349598282557`*^9}, {
   3.672835000598819*^9, 3.672835000976489*^9}, {3.672835053048051*^9, 
   3.672835096381859*^9}, 3.672835172112982*^9, 3.67283742986301*^9, {
   3.672837882113562*^9, 3.672837917923603*^9}, 3.673007560748815*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffx", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cl", ",", "len"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cl", "=", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "cl", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cl", "]"}], ">", "1"}], ",", 
        RowBox[{"cl", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672837462350689*^9, 3.672837514239416*^9}, {
  3.672837661203617*^9, 3.672837668845683*^9}, {3.67283773153292*^9, 
  3.672837784075696*^9}, {3.672999901180318*^9, 3.672999904205718*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FF", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fovam", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"coeffx", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fsperm", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", 
           RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx"}]}], ")"}], ",", 
         
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
        "]"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6728360928824453`*^9, 3.672836165366435*^9}, {
   3.672837187926056*^9, 3.672837279427154*^9}, 3.672837429870335*^9, {
   3.672837542951679*^9, 3.6728375990198603`*^9}, {3.672837638313529*^9, 
   3.6728376461492577`*^9}, {3.6728378030499077`*^9, 3.6728378400055313`*^9}, 
   3.672940253614581*^9, {3.672999909185938*^9, 3.672999909344338*^9}, {
   3.6730032569327374`*^9, 3.673003305047267*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CoefficientList", "[", 
  RowBox[{
   RowBox[{"FF", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", "r"}], "]"}]], "Input",
 CellChangeTimes->{{3.672999936694016*^9, 3.6729999509974413`*^9}, {
  3.6729999823178*^9, 3.672999983309154*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptF]", "[", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptF]", "[", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptF]", "[", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptF]", "[", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
      RowBox[{"2", " ", 
       RowBox[{"\[ScriptF]", "[", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
     RowBox[{"2", " ", 
      RowBox[{"\[ScriptF]", "[", 
       RowBox[{"{", 
        RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.672999951425624*^9, 3.672999983784361*^9, 
  3.6730026189927187`*^9, 3.673002660684102*^9, 3.67300327520857*^9, 
  3.673004004726807*^9, 3.6730075737013807`*^9, 3.673074746085669*^9, 
  3.67307490977335*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FF2", "=", "FF"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FF", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FF", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FF", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FF2", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"r", " ", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{"FF", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", "r"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672940461883422*^9, 3.6729405464832067`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FF2", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.672996557318204*^9, 3.672996560312999*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"f", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptF]", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"f", "[", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"\[ScriptF]", "[", 
          RowBox[{"{", 
           RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
      RowBox[{"1", "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
            RowBox[{"2", " ", 
             RowBox[{"\[ScriptF]", "[", 
              RowBox[{"{", 
               RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
          "-", 
          FractionBox[
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"{", 
              RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
         ")"}]}]}]},
     {
      FractionBox[
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", "Y", "}"}]}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "0", "0",
       "0"},
     {"0", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
          RowBox[{"{", "Y", "}"}]}], "]"}]}], 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.672996560721681*^9, 3.672998590011815*^9, 
  3.672999913475684*^9, 3.6730026190457077`*^9, 3.673002660737653*^9, 
  3.673003277306041*^9, 3.6730040047976923`*^9, 3.6730075737408047`*^9, 
  3.673074746146531*^9, 3.673074909814513*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix F eigenvectors", "Subsection",
 CellChangeTimes->{{3.672992907996264*^9, 3.672992914172285*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vvals", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"vf0", ",", "vf1", ",", "vm0", ",", "vm1"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvals", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "uf0", "}"}], ",", 
     RowBox[{"{", "uf1", "}"}], ",", 
     RowBox[{"{", "um0", "}"}], ",", 
     RowBox[{"{", "um1", "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6729924768251743`*^9, 3.67299248634032*^9}, {
  3.6729932209798737`*^9, 3.6729932374200153`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"demog", "=", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"FF2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "yf0"}], "+", 
      RowBox[{
       RowBox[{"FF2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "yf1"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"demogM", "=", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"FF2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "ym0"}], "+", 
      RowBox[{
       RowBox[{"FF2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}], "ym1"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6729444657801723`*^9, 3.6729444920834703`*^9}, {
  3.672945304345965*^9, 3.672945315135611*^9}, {3.6729458150517063`*^9, 
  3.67294581777153*^9}, {3.672946210923895*^9, 3.672946212118362*^9}, {
  3.672991449896881*^9, 3.672991459182775*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"vvals", ".", "FF2"}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6729925268695097`*^9, 3.672992590341445*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"vm0", " ", 
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
      RowBox[{"{", "Y", "}"}]}], "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"f", "[", 
     RowBox[{"{", 
      RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
  RowBox[{"vf1", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], ")"}]}],
   "+", 
  RowBox[{"vf0", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"F", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"{", 
             RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], "-", 
        FractionBox[
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.672992530552339*^9, 3.6729925908054037`*^9}, 
   3.672992684161509*^9, 3.672993458314172*^9, 3.672998590113988*^9, 
   3.6730026190832167`*^9, 3.6730026607843733`*^9, 3.673004004841715*^9, 
   3.673007573772634*^9, 3.673074746195539*^9, 3.673074909856948*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"vvals", ".", "FF2"}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6729927100524273`*^9, 3.672992744047913*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"vm0", " ", 
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
      RowBox[{"{", "Y", "}"}]}], "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"f", "[", 
     RowBox[{"{", 
      RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
  RowBox[{"vf1", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], ")"}]}],
   "+", 
  RowBox[{"vf0", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"F", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"{", 
             RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], "-", 
        FractionBox[
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6729927190828457`*^9, 3.672992730554297*^9}, 
   3.672993458336053*^9, 3.6729985901199503`*^9, 3.673002619107789*^9, 
   3.673002660820265*^9, 3.673004004874009*^9, 3.6730075737920523`*^9, 
   3.673074746221793*^9, 3.6730749098836803`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"FF2", ".", "uvals"}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.672993269167069*^9, 3.672993299693434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uf0", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], ")"}]}],
   "+", 
  RowBox[{"uf1", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"F", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"{", 
             RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
        "-", 
        FractionBox[
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}]}], "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
       ")"}]}]}], ")"}]}], "+", 
  RowBox[{"um0", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"\[ScriptF]", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]], "+", 
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"\[ScriptF]", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], ")"}]}],
   "+", 
  RowBox[{"um1", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"F", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"\[ScriptF]", "[", 
            RowBox[{"{", 
             RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
        "-", 
        FractionBox[
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}]}], "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}]]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6729932729491463`*^9, 3.67299330020011*^9}, 
   3.6729934583591633`*^9, 3.672998590149139*^9, 3.673002619132247*^9, 
   3.6730026608616533`*^9, 3.6730040048785667`*^9, 3.673007573811638*^9, 
   3.673074746247126*^9, 3.673074909911005*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"uveqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2", ".", "uvals"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "uf1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2", ".", "uvals"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "um0"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FF2", ".", "uvals"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "um1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvals", ".", "FF2"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "vf0"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvals", ".", "FF2"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "vf1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvals", ".", "FF2"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "vm0"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vvals", ".", "FF2"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"\[Lambda]", " ", "vm1"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672997265098961*^9, 3.672997400035041*^9}, {
  3.672997460865128*^9, 3.672997461744545*^9}, {3.673001065167368*^9, 
  3.673001080867169*^9}, {3.673001947158779*^9, 3.673001947261565*^9}, {
  3.6730023657303762`*^9, 3.6730023741751127`*^9}, {3.673002428000701*^9, 
  3.673002441356019*^9}, {3.6730024792464314`*^9, 3.673002499233531*^9}, {
  3.6730026525936623`*^9, 3.673002652922413*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uveqs2", "=", 
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"uveqs", ",", 
       RowBox[{"4", "\[Rule]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"uvals", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], 
            RowBox[{"vvals", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "\[Equal]", 
         "1"}]}]}], "]"}], "/.", 
     RowBox[{"uf0", "\[Rule]", 
      RowBox[{"1", "-", "uf1", "-", "um0", "-", "um1"}]}]}]}], ";"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67300251737919*^9, 3.67300255984381*^9}, 
   3.67300265643176*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsols", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"uveqs2", ",", 
       RowBox[{"{", 
        RowBox[{
        "uf1", ",", "um0", ",", "um1", ",", "vf0", ",", "vf1", ",", "vm0", 
         ",", "vm1"}], "}"}]}], "]"}], "//", "Simplify"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672997413146058*^9, 3.6729974771776323`*^9}, 
   3.673002562059359*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsolsExpl", "=", 
   RowBox[{"uvsols", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673000901373358*^9, 3.673000932022674*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charPol", "=", 
   RowBox[{
    RowBox[{"CharacteristicPolynomial", "[", 
     RowBox[{"FF2", ",", "\[Lambda]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"charPolExpl", "=", 
   RowBox[{"charPol", "/.", 
    RowBox[{"F", "->", "\[ScriptCapitalF]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673002764942953*^9, 3.673002786526408*^9}, {
  3.6730028869619637`*^9, 3.673002914408588*^9}, {3.6730034167768917`*^9, 
  3.673003423524884*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix W", "Subsection",
 CellChangeTimes->{{3.672992925371107*^9, 3.6729929265803347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fovam", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"X", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"coeffx", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fsperm", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", 
            RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]approx2"}]}], ")"}], 
          ",", 
          RowBox[{"\[ScriptF]", "[", 
           RowBox[{"{", 
            RowBox[{"Xd", ",", "\[ScriptCapitalX]1m"}], "}"}], "]"}]}], 
         "]"}]}], "}"}]}], "}"}], "/.", 
    RowBox[{"Null", "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6728360928824453`*^9, 3.672836165366435*^9}, {
   3.672837187926056*^9, 3.672837279427154*^9}, 3.672837429870335*^9, {
   3.672837542951679*^9, 3.6728375990198603`*^9}, {3.672837638313529*^9, 
   3.6728376461492577`*^9}, {3.6728378030499077`*^9, 
   3.6728378400055313`*^9}, {3.672837962210178*^9, 3.672837981624482*^9}, {
   3.6728380121445847`*^9, 3.672838048775083*^9}, 3.67298196369242*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical solving", "Section",
 CellChangeTimes->{{3.672977057403289*^9, 3.6729770616021223`*^9}, {
  3.6729793735252123`*^9, 3.672979376613474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FFexpl", "=", 
   RowBox[{"FF2", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6729968454899406`*^9, 3.67299685872477*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterRes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cfds_", ",", "cmds_", ",", "hs_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"rs_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"svs_", ",", "thf_", ",", "thm_", ",", "\[Kappa]s_"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"x1s_", ",", "x2s_"}], "}"}], ",", 
    RowBox[{"{", "tend_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "tx", ",", "subsbase", ",", "subslist", ",", "ffout", ",", 
      "uv", ",", "eval", ",", "cpol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "tend"}], "]"}], ",", 
        RowBox[{"4", "+", 
         RowBox[{"Length", "[", "haplos", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "4"}], ",", "4"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "5"}], ",", "5"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subsbase", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cfd", "\[Rule]", "cfds"}], ",", 
        RowBox[{"cmd", "\[Rule]", "cmds"}], ",", 
        RowBox[{"h", "\[Rule]", "hs"}], ",", 
        RowBox[{"r", "\[Rule]", "rs"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"sv", "\[Rule]", "svs"}], ",", 
        RowBox[{
         RowBox[{"th", "[", "f", "]"}], "\[Rule]", "thf"}], ",", 
        RowBox[{
         RowBox[{"th", "[", "m", "]"}], "\[Rule]", "thm"}], ",", 
        RowBox[{"x1", "\[Rule]", "x1s"}], ",", 
        RowBox[{"x2", "\[Rule]", "x2s"}], ",", 
        RowBox[{"\[Kappa]", "->", "\[Kappa]s"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"tx", "=", "2"}], ",", 
       RowBox[{"tx", "\[LessEqual]", "tend"}], ",", 
       RowBox[{"tx", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"subslist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"haplos", "[", 
                RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"ix", ",", 
                 RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[ScriptF]", "[", 
               RowBox[{"haplos", "[", 
                RowBox[{"[", 
                 RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"ix", ",", 
                 RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
           "subsbase"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "tx"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"fovaExpl", ",", "fspermExpl"}], "]"}], "/.", 
           "subslist"}], "//", "Flatten"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffout", "=", 
      RowBox[{"FFexpl", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", 
               RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
         "subsbase"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eval", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Eigenvalues", "[", "ffout", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "eval", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"uv", "=", 
      RowBox[{"uvsolsExpl", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", "\[Rule]", "eval"}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", 
               RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
         "subsbase"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "uv"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", "\[Rule]", "eval"}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", "ix", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptF]", "[", 
             RowBox[{"haplos", "[", 
              RowBox[{"[", 
               RowBox[{"ix", "-", "4"}], "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", 
               RowBox[{"tx", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ix", ",", "5", ",", "9"}], "}"}]}], "]"}], ",", 
         "subsbase"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"Transpose", "[", "ffout", "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Eigenvectors", "[", "ffout", "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "uv", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "eval", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "data", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672977064087887*^9, 3.672977070762644*^9}, {
   3.6729771574105797`*^9, 3.6729772619247*^9}, {3.672977337630439*^9, 
   3.672977433108034*^9}, {3.672977509762248*^9, 3.6729775336708508`*^9}, {
   3.672977567518033*^9, 3.672977665959683*^9}, {3.672977723598529*^9, 
   3.672977835121368*^9}, {3.672977866533164*^9, 3.67297800535069*^9}, 
   3.6729781011849937`*^9, {3.67297814625066*^9, 3.67297817870649*^9}, {
   3.67297820951271*^9, 3.6729782267895823`*^9}, {3.672978278338504*^9, 
   3.672978285229126*^9}, {3.672978364324605*^9, 3.672978369718773*^9}, {
   3.6729820541726427`*^9, 3.672982065904419*^9}, {3.672996885449079*^9, 
   3.672997020956637*^9}, {3.6729970895379744`*^9, 3.672997091575659*^9}, {
   3.6729971235347033`*^9, 3.672997134535787*^9}, {3.672998624961905*^9, 
   3.6729986317580013`*^9}, {3.6729989189984827`*^9, 3.672998942070805*^9}, {
   3.6729990154121857`*^9, 3.672999035294465*^9}, {3.673000941021862*^9, 
   3.6730009965169077`*^9}, {3.673001114885334*^9, 3.6730011389380503`*^9}, {
   3.6730011765039043`*^9, 3.673001178547339*^9}, {3.673002807598173*^9, 
   3.673002872723709*^9}, {3.6730029201648684`*^9, 3.673002995655232*^9}, {
   3.673005727351565*^9, 3.673005736066675*^9}, {3.673007210256049*^9, 
   3.6730072474493113`*^9}, {3.673007314972084*^9, 3.673007368802058*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"iterRes", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0.95"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", 
       RowBox[{"-", "2"}], ",", "2", ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", "400", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6729776682935658`*^9, 3.672977701955155*^9}, {
   3.672978181660576*^9, 3.672978239303278*^9}, {3.672979529445166*^9, 
   3.6729795509709*^9}, {3.672981900181178*^9, 3.67298190040022*^9}, {
   3.672982132068437*^9, 3.672982150310956*^9}, {3.6729851023814793`*^9, 
   3.6729851025398283`*^9}, {3.6729970475339527`*^9, 3.67299704768305*^9}, {
   3.672997110162573*^9, 3.6729971104191093`*^9}, {3.672998634978409*^9, 
   3.672998639114291*^9}, 3.673003327580894*^9, 3.673005094442788*^9, {
   3.6730053302230387`*^9, 3.673005351566833*^9}, {3.6730055581718073`*^9, 
   3.673005559651506*^9}, {3.6730056614087877`*^9, 3.6730056615371237`*^9}, {
   3.6730073855786047`*^9, 3.673007386180263*^9}, {3.673007425045146*^9, 
   3.673007426931168*^9}, {3.6730091077526073`*^9, 3.673009127696206*^9}, {
   3.6730091891009903`*^9, 3.673009226042317*^9}, {3.6730106226565742`*^9, 
   3.673010631207964*^9}, {3.6730106634690332`*^9, 3.673010678720584*^9}, {
   3.6730771431355*^9, 3.673077155382883*^9}}],

Cell[CellGroupData[{

Cell[BoxData["1.4875293790099604`"], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163755096*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.008398859529727628`"}]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.6730771639442453`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5148128901218351`", "0.6499058225416775`", "0.3581848556100263`", 
      "0.42929444347959317`"},
     {"0.7650569106322253`", 
      RowBox[{"-", "0.36716484516572206`"}], "0.4836353537040249`", 
      RowBox[{"-", "0.21441722089396004`"}]},
     {
      RowBox[{"-", "0.15057165241360557`"}], 
      RowBox[{"-", "0.42051177608410184`"}], "0.3797766413475693`", 
      "0.8101035281683385`"},
     {
      RowBox[{"-", "0.4385457600061173`"}], "0.15241749635646426`", 
      "0.8515470946310436`", 
      RowBox[{"-", "0.24354479836472095`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.67307716394522*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.39118004425592057`", "0.805691340382981`", "0.1742864780125846`", 
      "0.40922348489521054`"},
     {"0.6924068482518695`", 
      RowBox[{"-", "0.5367120280512294`"}], "0.36133452662171034`", 
      RowBox[{"-", "0.31929659457957477`"}]},
     {
      RowBox[{"-", "0.1731271807137305`"}], 
      RowBox[{"-", "0.5214914828218932`"}], "0.23360802915997536`", 
      "0.8021850792394051`"},
     {
      RowBox[{"-", "0.4921120710343458`"}], "0.19648445042466453`", 
      "0.7718725070981847`", 
      RowBox[{"-", "0.3513294793631288`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163946032*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uf1", "\[Rule]", "0.45253863252004944`"}], ",", 
   RowBox[{"um0", "\[Rule]", "0.09789277912439558`"}], ",", 
   RowBox[{"um1", "\[Rule]", "0.2298515907612201`"}], ",", 
   RowBox[{"vf0", "\[Rule]", "0.9516682458047105`"}], ",", 
   RowBox[{"vf1", "\[Rule]", "1.201397140483679`"}], ",", 
   RowBox[{"vm0", "\[Rule]", "0.662130183126411`"}], ",", 
   RowBox[{"vm1", "\[Rule]", "0.7935813142970278`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.6730771639468603`*^9}}],

Cell[BoxData["1.4875293790099604`"], "Print",
 CellChangeTimes->{{3.672998933323271*^9, 3.672998947848357*^9}, 
   3.672999041751917*^9, {3.6730009667923403`*^9, 3.6730010033749123`*^9}, 
   3.6730011472573566`*^9, 3.6730011841813374`*^9, 3.673001972365926*^9, 
   3.6730026408869677`*^9, 3.673002678952766*^9, 3.673002827628881*^9, {
   3.6730028660525093`*^9, 3.673002878255519*^9}, {3.673002927660892*^9, 
   3.673003001045278*^9}, 3.6730033328531437`*^9, 3.673004015273898*^9, 
   3.6730051155229063`*^9, {3.673005336817149*^9, 3.673005356142624*^9}, 
   3.6730055657479763`*^9, 3.673005666026531*^9, 3.673005741835594*^9, 
   3.673007255414679*^9, {3.67300732559372*^9, 3.6730073906180964`*^9}, 
   3.6730074316515293`*^9, 3.673007585103504*^9, {3.673009113246221*^9, 
   3.673009132472268*^9}, {3.673009194146461*^9, 3.673009230727418*^9}, 
   3.673010639129842*^9, {3.67301067158254*^9, 3.673010690379486*^9}, 
   3.673074758669557*^9, 3.673074812817168*^9, 3.6730749259711657`*^9, {
   3.6730771516273518`*^9, 3.673077163947653*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673007272949192*^9, 3.673007275182843*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"1", ";;", "9"}], ",", "400"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.673005567177265*^9, 3.673005570815073*^9}, {
  3.673005667300487*^9, 3.673005667869763*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.1930342435990941`", ",", "0.19303424359909416`", ",", 
   "0.3069657564009059`", ",", "0.3069657564009059`", ",", 
   "0.1279347586980277`", ",", "0.1279347586980277`", ",", 
   "0.23192395847374733`", ",", "0.23192395847374733`", ",", 
   "0.2802825656564499`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6730055712163897`*^9, 3.6730056684218473`*^9, 3.673007585276458*^9, 
   3.673009145717849*^9, {3.6730091974834843`*^9, 3.673009242083621*^9}, {
   3.6730106466163597`*^9, 3.673010694331554*^9}, 3.6730747589109497`*^9, 
   3.673074926283709*^9, 3.673074960187661*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to C", "Section",
 CellChangeTimes->{{3.672985837060911*^9, 3.6729858383888702`*^9}}],

Cell[CellGroupData[{

Cell["Recursions of resident", "Subsection",
 CellChangeTimes->{{3.673004574014861*^9, 3.673004578501451*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/drive/src/numerical/drive_continuous/expressions_resident.\
txt\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672985844827239*^9, 3.672985873622394*^9}, {
  3.672986600729083*^9, 3.672986601897593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.672985916394869*^9, 3.672985921945785*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tx", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"CForm", "[", 
    RowBox[{"x", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalX]1", "\[Rule]", "X1"}], ",", 
       RowBox[{"\[ScriptCapitalX]2", "\[Rule]", "X2"}], ",", 
       RowBox[{"\[ScriptCapitalX]1m", "\[Rule]", "X1"}], ",", 
       RowBox[{"\[ScriptCapitalX]2m", "\[Rule]", "X2"}], ",", 
       RowBox[{"f", "\[Rule]", "ff"}], ",", 
       RowBox[{"\[ScriptF]", "\[Rule]", "fm"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.672985968228217*^9, 3.672985986649579*^9}, {
  3.672986376415182*^9, 3.672986416108233*^9}, {3.672986489746086*^9, 
  3.672986504470744*^9}}],

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"ix", "=", "1"}], ",", 
   RowBox[{"ix", "\[LessEqual]", "4"}], ",", 
   RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"f", "[", 
        RowBox[{"haplos", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\<_tplus1 = \>\"", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"fovaExpl", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"ix", "=", "1"}], ",", 
   RowBox[{"ix", "\[LessEqual]", "5"}], ",", 
   RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"\[ScriptF]", "[", 
        RowBox[{"haplos", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\<_tplus1 = \>\"", "<>", 
      RowBox[{"tx", "[", 
       RowBox[{"fspermExpl", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.672985885635339*^9, 3.672985955282421*^9}, {
  3.672985990402998*^9, 3.67298609359571*^9}, {3.6729861437521143`*^9, 
  3.672986150525977*^9}, {3.672986261430307*^9, 3.672986266650399*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "str"}], "]"}]], "Input",
 CellChangeTimes->{{3.672986333055067*^9, 3.672986349308429*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
expressions_resident.txt\"\>"], "Output",
 CellChangeTimes->{
  3.6729863499520884`*^9, 3.672986420774602*^9, 3.6729865134247417`*^9, 
   3.67298660756936*^9, 3.67298725916017*^9, 3.672990866968713*^9, {
   3.67299344824937*^9, 3.672993459001214*^9}, 3.6729935067496643`*^9, {
   3.6729940099276752`*^9, 3.672994023355919*^9}, 3.672996249446136*^9, 
   3.672997553029632*^9, 3.6729985966356907`*^9, 3.673004015515016*^9, 
   3.673004676421116*^9, 3.673007585354643*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix F", "Subsection",
 CellChangeTimes->{{3.673004595404806*^9, 3.673004596787981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/drive/src/numerical/drive_continuous/expressions_fmatrix.\
txt\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6730042895755157`*^9, 3.6730043087478724`*^9}, {
  3.6730044968919992`*^9, 3.67300449738866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FF2Expl", "=", 
   RowBox[{"FF2", "/.", 
    RowBox[{"F", "\[Rule]", "\[ScriptCapitalF]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673004253856111*^9, 3.673004267570982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<double data[] = {\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.6730043275876417`*^9, 3.673004350890863*^9}, 
   3.67300450195546*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "FF2Expl", "]"}]}], ",", 
    RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iy", "=", "1"}], ",", 
       RowBox[{"iy", "\[LessEqual]", 
        RowBox[{"Length", "[", "FF2Expl", "]"}]}], ",", 
       RowBox[{"iy", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", 
          RowBox[{"tx", "[", 
           RowBox[{"FF2Expl", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", "iy"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<,\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<};\>\""}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673004273291305*^9, 3.673004335413179*^9}, {
  3.673004373750905*^9, 3.673004511173375*^9}, {3.673004552513576*^9, 
  3.673004552990168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"file", ",", "str"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.673004513751124*^9, 3.67300452042773*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvectors", "Subsection",
 CellChangeTimes->{{3.673004610788908*^9, 3.673004613139804*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uvsolsExpl", "=", "uvsolsExpl"}], ";"}]], "Input",
 CellChangeTimes->{{3.67299398665455*^9, 3.672994005884869*^9}, {
   3.672997492695086*^9, 3.6729974986495037`*^9}, 3.67300580827897*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/drive/src/numerical/drive_continuous/expressions_eigenvecs.\
txt\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.672990455726048*^9, {3.6729930032529*^9, 3.6729930048201523`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<uf0 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{
      RowBox[{"1", "-", "uf1", "-", "um0", "-", "um1"}], "/.", "uvsolsExpl"}],
      "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<uf1 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"uf1", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<um0 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"um0", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<um1 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"um1", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vf0 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vf0", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vf1 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vf1", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vm0 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vm0", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<vm1 = \>\"", "<>", 
    RowBox[{"tx", "[", 
     RowBox[{"vm1", "/.", "uvsolsExpl"}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.672990465144394*^9, 3.672990468715304*^9}, 
   3.672990524297229*^9, {3.6729930516807737`*^9, 3.672993205777204*^9}, {
   3.672993431903842*^9, 3.672993442031107*^9}, {3.6729934948216467`*^9, 
   3.672993503437038*^9}, {3.67299395393217*^9, 3.672993969081656*^9}, 
   3.672994020307065*^9, {3.672997510997814*^9, 3.672997542870255*^9}, {
   3.6730033810944633`*^9, 3.673003402138884*^9}, {3.673003451165786*^9, 
   3.673003473734568*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "str"}], "]"}]], "Input",
 CellChangeTimes->{{3.67299313334114*^9, 3.672993133948143*^9}, {
  3.672993513779422*^9, 3.672993519051578*^9}, {3.672997545699383*^9, 
  3.672997547828822*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
expressions_eigenvecs.txt\"\>"], "Output",
 CellChangeTimes->{{3.6729931343917913`*^9, 3.672993148902034*^9}, {
   3.672993448301614*^9, 3.6729934590355053`*^9}, {3.672993506860765*^9, 
   3.6729935193915443`*^9}, 3.672994023548417*^9, 3.672996249700584*^9, {
   3.672997546277689*^9, 3.6729975534440928`*^9}, 3.672998597131549*^9, 
   3.673004016247077*^9, 3.6730046772134132`*^9, 3.673007585779819*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutant selection gradient", "Subsection",
 CellChangeTimes->{{3.673004667505797*^9, 3.673004671888569*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Variables"}]], "Input",
 CellChangeTimes->{{3.673007160255237*^9, 3.6730071683566637`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "cfd", ",", "h", ",", "r", ",", "sv", ",", "x1", ",", "x2", ",", "\[Kappa]",
    ",", 
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}], ",", 
   RowBox[{"th", "[", "f", "]"}], ",", 
   RowBox[{"\[ScriptF]", "[", 
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}], ",", 
   RowBox[{"\[ScriptF]", "[", 
    RowBox[{"{", 
     RowBox[{"X", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}], ",", 
   RowBox[{"\[ScriptF]", "[", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}], ",", 
   RowBox[{"\[ScriptF]", "[", 
    RowBox[{"{", 
     RowBox[{"Xd", ",", "\[ScriptCapitalX]2"}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.673007160952573*^9, 3.6730071687955313`*^9}, 
   3.673007585829946*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"vvals", ".", "W", ".", "uvals"}], "/", 
    RowBox[{"(", 
     RowBox[{"vvals", ".", "uvals"}], ")"}]}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.673007193101342*^9, 3.673007198138883*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{498., {3., 12.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         FractionBox[
          RowBox[{
           RowBox[{"um1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vf0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", 
                    FractionBox[
                    SuperscriptBox[
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "2"], 
                    RowBox[{"2", " ", 
                    SuperscriptBox[
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], 
                    "2"]}]]}]], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"cfd", " ", "h"}]}], ")"}], " ", "r", " ", 
                    "\[Kappa]", " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"{", 
                    RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}], 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x1"}], "-", 
                    RowBox[{"th", "[", "f", "]"}]}], ")"}]}], 
                   RowBox[{"2", " ", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Kappa]", "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", 
                    FractionBox[
                    SuperscriptBox[
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "2"], 
                    RowBox[{"2", " ", 
                    RowBox[{
                    "\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]]}]], " ", 
                    "\[Kappa]"}]}], ")"}], " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"{", 
                    RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}], 
                    " ", 
                    RowBox[{"\[ScriptF]", "[", 
                    RowBox[{"{", 
                    RowBox[{"X", ",", "\[ScriptCapitalX]1"}], "}"}], "]"}]}], 
                    "+", 
                    RowBox[{"\[LeftSkeleton]", "14", "\[RightSkeleton]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "cfd"}], ")"}], " ", 
                    RowBox[{"\[LeftSkeleton]", "3", "\[RightSkeleton]"}]}]}], 
                    ")"}]}]]}], "-", 
                 FractionBox[
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
                ")"}]}], "+", 
              RowBox[{"vf1", " ", 
               RowBox[{"(", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], "+", 
           RowBox[{"uf0", " ", 
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]}], 
          RowBox[{
           RowBox[{"uf0", " ", "vf0"}], "+", 
           RowBox[{"uf1", " ", "vf1"}], "+", 
           RowBox[{"um0", " ", "vm0"}], "+", 
           RowBox[{"um1", " ", "vm1"}]}]],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{80., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1215, 29908833091918787804, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{92., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1215, 29908833091918787804, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{68., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1215, 29908833091918787804, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{119., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[1215]]], "Output",
 CellChangeTimes->{{3.6730071948211737`*^9, 3.673007198671406*^9}, 
   3.673007291633032*^9, 3.67300758588509*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vvals", ".", "W", ".", "uvals"}], "/.", "uvsols"}]], "Input",
 CellChangeTimes->{{3.673008293812725*^9, 3.673008310034462*^9}, {
  3.673008581241056*^9, 3.673008586494108*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{498., {3., 12.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "}"}], "}"}],
         
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{80., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1221, 29908833091918787804, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{92., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1221, 29908833091918787804, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{68., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1221, 29908833091918787804, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{119., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[1221]]], "Output",
 CellChangeTimes->{{3.6730082998443727`*^9, 3.6730083106080523`*^9}, 
   3.67300858771036*^9}]
}, Open  ]],

Cell[BoxData["."], "Input",
 CellChangeTimes->{3.6730090849816847`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"selgrad", "=", 
   RowBox[{"tx", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vvals", ".", "W", ".", "uvals"}], "/", 
       RowBox[{"(", 
        RowBox[{"vvals", ".", "uvals"}], ")"}]}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6729942216310663`*^9, 3.6729942637092257`*^9}, {
  3.6729943090373783`*^9, 3.6729943524509974`*^9}, {3.672994435326788*^9, 
  3.672994491650855*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/drive/src/numerical/drive_continuous/selgrad.txt\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"file", ",", "selgrad"}], "]"}]}], "Input",
 CellChangeTimes->{{3.672994454447772*^9, 3.6729944550906353`*^9}, {
  3.672994525265111*^9, 3.672994550952198*^9}}],

Cell[BoxData["\<\"/home/bram/Projects/drive/src/numerical/drive_continuous/\
selgrad.txt\"\>"], "Output",
 CellChangeTimes->{3.672994455623229*^9, 3.6729944929456053`*^9, 
  3.6729945542709217`*^9, 3.6729962497492332`*^9, 3.672997553487974*^9, 
  3.672998597232205*^9, 3.6730040162992477`*^9, 3.673004677263309*^9, 
  3.673007585939766*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 170, 2, 96, "Section"],
Cell[752, 26, 138, 2, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[927, 33, 147, 2, 96, "Section"],
Cell[1077, 37, 126, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[1228, 42, 497, 13, 45, "Input"],
Cell[1728, 57, 836, 18, 45, "Output"]
}, Open  ]],
Cell[2579, 78, 301, 6, 45, "Text"],
Cell[2883, 86, 2707, 67, 266, "Input"],
Cell[5593, 155, 128, 1, 45, "Text"],
Cell[5724, 158, 1781, 47, 220, "Input"],
Cell[7508, 207, 113, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[7646, 212, 675, 19, 45, "Input"],
Cell[8324, 233, 19049, 552, 1288, "Output"]
}, Open  ]],
Cell[27388, 788, 207, 3, 45, "Text"],
Cell[27598, 793, 3467, 90, 482, "Input"],
Cell[CellGroupData[{
Cell[31090, 887, 806, 24, 75, "Input"],
Cell[31899, 913, 38063, 990, 738, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69999, 1908, 452, 10, 45, "Input"],
Cell[70454, 1920, 575, 9, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71078, 1935, 170, 2, 96, "Section"],
Cell[71251, 1939, 99, 1, 45, "Text"],
Cell[71353, 1942, 1845, 49, 104, "Input"],
Cell[73201, 1993, 102, 1, 45, "Text"],
Cell[73306, 1996, 1191, 32, 75, "Input"],
Cell[74500, 2030, 105, 1, 45, "Text"],
Cell[74608, 2033, 913, 25, 45, "Input"],
Cell[75524, 2060, 191, 4, 45, "Text"],
Cell[75718, 2066, 418, 12, 75, "Input"],
Cell[CellGroupData[{
Cell[76161, 2082, 132, 2, 45, "Input"],
Cell[76296, 2086, 427, 6, 45, "Output"]
}, Open  ]],
Cell[76738, 2095, 92, 1, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76867, 2101, 140, 2, 96, "Section"],
Cell[77010, 2105, 262, 3, 45, "Text"],
Cell[77275, 2110, 481, 12, 45, "Input"],
Cell[77759, 2124, 1476, 39, 75, "Input"],
Cell[79238, 2165, 972, 24, 45, "Input"],
Cell[80213, 2191, 259, 5, 45, "Text"],
Cell[80475, 2198, 120, 2, 45, "Input"],
Cell[80598, 2202, 1148, 29, 86, "Input"],
Cell[81749, 2233, 672, 15, 45, "Input"],
Cell[82424, 2250, 1043, 26, 191, "Input"],
Cell[83470, 2278, 7659, 210, 510, "Input"],
Cell[CellGroupData[{
Cell[91154, 2492, 287, 7, 45, "Input"],
Cell[91444, 2501, 2638, 76, 125, "Output"]
}, Open  ]],
Cell[94097, 2580, 1848, 59, 162, "Input"],
Cell[CellGroupData[{
Cell[95970, 2643, 127, 2, 45, "Input"],
Cell[96100, 2647, 9335, 260, 215, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105472, 2912, 109, 1, 67, "Subsection"],
Cell[105584, 2915, 552, 16, 75, "Input"],
Cell[106139, 2933, 1036, 32, 75, "Input"],
Cell[CellGroupData[{
Cell[107200, 2969, 222, 6, 45, "Input"],
Cell[107425, 2977, 2567, 74, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110029, 3056, 222, 6, 45, "Input"],
Cell[110254, 3064, 2547, 74, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112838, 3143, 220, 6, 45, "Input"],
Cell[113061, 3151, 4187, 123, 128, "Output"]
}, Open  ]],
Cell[117263, 3277, 2273, 59, 220, "Input"],
Cell[119539, 3338, 840, 25, 45, "Input"],
Cell[120382, 3365, 442, 13, 45, "Input"],
Cell[120827, 3380, 219, 5, 45, "Input"],
Cell[121049, 3387, 518, 13, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121604, 3405, 98, 1, 67, "Subsection"],
Cell[121705, 3408, 7934, 212, 510, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129688, 3626, 155, 2, 96, "Section"],
Cell[129846, 3630, 213, 5, 45, "Input"],
Cell[130062, 3637, 9745, 238, 713, "Input"],
Cell[CellGroupData[{
Cell[139832, 3879, 1476, 28, 45, "Input"],
Cell[CellGroupData[{
Cell[141333, 3911, 1041, 14, 34, "Print"],
Cell[142377, 3927, 1062, 15, 34, "Print"],
Cell[143442, 3944, 2101, 42, 99, "Print"],
Cell[145546, 3988, 2100, 42, 99, "Print"],
Cell[147649, 4032, 1470, 23, 34, "Print"],
Cell[149122, 4057, 1041, 14, 34, "Print"]
}, Open  ]]
}, Open  ]],
Cell[150190, 4075, 92, 1, 45, "Input"],
Cell[CellGroupData[{
Cell[150307, 4080, 246, 6, 45, "Input"],
Cell[150556, 4088, 618, 12, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151223, 4106, 98, 1, 96, "Section"],
Cell[CellGroupData[{
Cell[151346, 4111, 110, 1, 67, "Subsection"],
Cell[151459, 4114, 312, 8, 45, "Input"],
Cell[151774, 4124, 142, 3, 45, "Input"],
Cell[151919, 4129, 724, 17, 45, "Input"],
Cell[152646, 4148, 1459, 37, 191, "Input"],
Cell[CellGroupData[{
Cell[154130, 4189, 153, 3, 45, "Input"],
Cell[154286, 4194, 546, 8, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[154881, 4208, 96, 1, 67, "Subsection"],
Cell[154980, 4211, 316, 8, 45, "Input"],
Cell[155299, 4221, 213, 5, 45, "Input"],
Cell[155515, 4228, 186, 4, 45, "Input"],
Cell[155704, 4234, 1225, 31, 220, "Input"],
Cell[156932, 4267, 171, 4, 67, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157140, 4276, 100, 1, 97, "Subsection"],
Cell[157243, 4279, 223, 4, 67, "Input"],
Cell[157469, 4285, 289, 8, 67, "Input"],
Cell[157761, 4295, 2247, 56, 373, "Input"],
Cell[CellGroupData[{
Cell[160033, 4355, 250, 5, 67, "Input"],
Cell[160286, 4362, 481, 6, 67, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160816, 4374, 113, 1, 97, "Subsection"],
Cell[CellGroupData[{
Cell[160954, 4379, 203, 5, 67, "Input"],
Cell[161160, 4386, 1175, 32, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162372, 4423, 316, 9, 67, "Input"],
Cell[162691, 4434, 7776, 203, 421, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170504, 4642, 211, 4, 67, "Input"],
Cell[170718, 4648, 4287, 124, 238, "Output"]
}, Open  ]],
Cell[175020, 4775, 71, 1, 67, "Input"],
Cell[175094, 4778, 522, 14, 67, "Input"],
Cell[CellGroupData[{
Cell[175641, 4796, 396, 10, 112, "Input"],
Cell[176040, 4808, 340, 5, 67, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
