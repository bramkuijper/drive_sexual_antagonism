#include <ctime>
#include <iostream>
#include <fstream>
#include <sstream>
#include <iomanip>
#include <algorithm>
#include <string>
#include <cmath>
#include <cassert>
#include <gsl/gsl_rng.h>
#include <gsl/gsl_randist.h>
#include <gsl/gsl_math.h>
#include <gsl/gsl_eigen.h>
#include "bramauxiliary.h"


//#define NDEBUG

using namespace std;

// give the outputfile a unique name based on a timestamp
// involving nanoseconds
// by using the create_filename function (see 
// "bramauxiliary.h")
string filename("iter_drive_continous");
string filename_new(create_filename(filename));
ofstream DataFile(filename_new.c_str());  // output file 




int main(int argc, char **argv)
{
    double kappa = atof(argv[1]);
    double sv = atof(argv[2]);
    double k = atof(argv[3]);
    double th_ff = atof(argv[4]);
    double th_m = atof(argv[5]);
    double cmd = atof(argv[6]);
    double cfd = atof(argv[7]);
    double h = atof(argv[8]);
    double r = atof(argv[9]);

    double x1 = 0;
    double x2 = 0;

    double E = exp(1);

    double ff_X_X1_tplus1, ff_X_X2_tplus1, 
           ff_Xd_X1_tplus1, ff_Xd_X2_tplus1, 
           fm_X_X1_tplus1, fm_X_X2_tplus1, 
           fm_Xd_X1_tplus1, fm_Xd_X2_tplus1, fm_Y_tplus1;

    double ff_X_X1, ff_X_X2, 
           ff_Xd_X1, ff_Xd_X2, 
           fm_X_X1, fm_X_X2, 
           fm_Xd_X1, fm_Xd_X2, fm_Y;
 
    ff_X_X1 = ff_X_X2 = 
           ff_Xd_X1 = ff_Xd_X2 = 0.25;

    fm_X_X1 = fm_X_X2 = 
           fm_Xd_X1 = fm_Xd_X2 = fm_Y = 1.0/5;

    double bound = 1e-07;

    int maxt = 10000000;

    DataFile << "ff_X_X1;ff_X_X2;ff_Xd_X1;ff_Xd_X2;fm_X_X1;fm_X_X2;fm_Xd_X1;fm_Xd_X2;" << endl;

    for (int tx = 0; tx < maxt; ++tx)
    {
        // first update the resident frequencies
        for (int tx2 = 0; tx2 < maxt; ++tx2)
        {
            ff_X_X1_tplus1 = ((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1)/((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2) + ((1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

ff_X_X2_tplus1 = ((1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2)/((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

ff_Xd_X1_tplus1 = ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1)/((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

ff_Xd_X2_tplus1 = ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)/((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2);

fm_X_X1_tplus1 = ((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y)/(2.*((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y));

fm_X_X2_tplus1 = ((1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y)/(2.*((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y));

fm_Xd_X1_tplus1 = ((1 - cmd)*k*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y)/((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y);

fm_Xd_X2_tplus1 = ((1 - cmd)*k*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y)/((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y);

fm_Y_tplus1 = ((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y)/(2.*((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y)) + ((1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y)/(2.*((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y)) + ((1 - cmd)*(1 - k)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y)/((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y) + ((1 - cmd)*(1 - k)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y)/((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y);




            if (
                    fabs(ff_X_X1_tplus1 - ff_X_X1) < bound &&
                    fabs(ff_X_X2_tplus1 - ff_X_X2) < bound &&
                    fabs(ff_Xd_X1_tplus1 - ff_Xd_X1) < bound &&
                    fabs(ff_Xd_X2_tplus1 - ff_Xd_X2) < bound &&
                    fabs(fm_X_X1_tplus1 - fm_X_X1) < bound &&
                    fabs(fm_X_X2_tplus1 - fm_X_X2) < bound &&
                    fabs(fm_Xd_X1_tplus1 - fm_Xd_X1) < bound &&
                    fabs(fm_Xd_X2_tplus1 - fm_Xd_X2) < bound &&
                    fabs(fm_Y_tplus1 - fm_Y) < bound
            )
            {
                break;
            }
    
            ff_X_X1 = ff_X_X1_tplus1;
            ff_X_X2 = ff_X_X2_tplus1;
            ff_Xd_X1 = ff_Xd_X1_tplus1;
            ff_Xd_X2 = ff_Xd_X2_tplus1;

            fm_X_X1 = fm_X_X1_tplus1;
            fm_X_X2 = fm_X_X2_tplus1;
            fm_Xd_X1 = fm_Xd_X1_tplus1;
            fm_Xd_X2 = fm_Xd_X2_tplus1;
            fm_Y = fm_Y_tplus1;
        }

        double data[4][4];

        data[0][0] = ((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[0][1] = ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[0][2] = ((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[0][3] = ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[1][0] = ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[1][1] = ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*fm_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*fm_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*fm_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*fm_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[1][2] = ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*r*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[1][3] = ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd*h)*(1 - r)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2)) + ((1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2)/(2.*((1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X1 + (1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_X_X2 + (1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_X_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x1 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X1 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X1 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Xd_X2 + (1 - cfd*h)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(x1 + x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Xd_X2 + (1 - cfd)*(1 - kappa + kappa/pow(E,pow(2*x2 - th_ff,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Xd_X2));

data[2][0] = ((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*fm_Y)/(2.*((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y));

data[2][1] = 0;

data[2][2] = 0;

data[2][3] = 0;

data[3][0] = 0;

data[3][1] = ((1 - cmd)*k*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*fm_Y)/((1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_X_X1*fm_Y + (1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_X_X2*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x1 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X1*fm_Y + (1 - cmd)*(1 - kappa + kappa/pow(E,pow(x2 - th_m,2)/(2.*pow(sv,2))))*ff_Xd_X2*fm_Y);

data[3][2] = 0;

data[3][3] = 0;



        // on the basis  of which we calculate eigenvalues and eigenvectors
        gsl_matrix_view m = gsl_matrix_view_array (data, 4, 4);
        
        gsl_vector *eval = gsl_vector_alloc (4);
        gsl_matrix *evec = gsl_matrix_alloc (4, 4);

        gsl_eigen_symmv_workspace * w = gsl_eigen_symmv_alloc (4);

        gsl_eigen_symmv (&m.matrix, eval, evec, w);

        gsl_eigen_symmv_free (w);

        gsl_eigen_symmv_sort (eval, evec, 
                            GSL_EIGEN_SORT_ABS_ASC); 

        for (int i = 0; i < 4; ++i)
        {
            for (int i = 0; i < 4; ++i)
            {
            }
        }
        // then allow for invasion of a mutant
    }
}
